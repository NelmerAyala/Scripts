-- ----------------------------------------------------------------------------------------------
-- --------------------------- REPLICACIÃ“N DE AFV-SFL -------------------------------------------
-- ----------------------------------------------------------------------------------------------

-- ------------------
-- --- RETENCIONES --
-- ------------------

-- Consulta (PRD SILLACA)
SELECT * from dbafv.retencion r  where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in ( (60474,25,'v0116') );

-- Generar INSERT del registro consultado 
INSERT INTO dbafv.retencion
(IDRETENCION, IDCONSECUTIVO, IDMONEDA, IDDOCUMENTO, IDEMISOR, IDRECEPTOR, IDCANALVENTA, IDCOLABORADOR, IDZONA, NUMEROCOMPROBANTE, FECHACOMPROBANTE, FECHAEMISION, FECHAACTUALIZACION, MONTORETENCION, MONTORETENCION_D, ID_CAMBIO, OBSERVACIONES, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, ESTATUSRETENCION, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
VALUES(60474, 0, 100, 10, 17017, 1, 6, 209, 25, '20231200001724', '2023-12-15', '2023-12-15', NULL, 129.5300, 4610.5634, NULL, '', '2023-12-15 16:13:57', 'v0116', NULL, NULL, 'V', 'V', '2023-12-15 22:53:03', 935629, 0)
ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);



-- ------------------
-- --- RECIBOS ------
-- ------------------

-- Consulta (PRD FEBECA)
SELECT * from dbafv.recibo r  where (r.IDRECIBO, r.IDZONA, r.USUARIOCREACION) in ( 
(60385,353,'v0093')
);

-- Generar INSERT del registro consultado 
INSERT INTO dbafv.recibo
(IDRECIBO, IDCONSECUTIVO, IDDOCUMENTO, NUMERORECIBO, IDRECEPTORRECIBO, IDEMISORRECIBO, IDCANALVENTA, FECHAEMISION, FECHAVENCIMIENTO, FECHAACTUALIZACION, MONTORECIBO, MONTOSOBREPAGO, MONTORECIBO_D, MONTOSOBREPAGO_D, TASA_CAMBIO, IDMONEDA, IDZONA, IDCOLABORADOR, OBSERVACIONES, USUARIOACTUALIZACION, IMPRESIONRECIBO, FECHAIMPRESION, ESTATUSRECIBO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION, DIFERENCIALCAMBIARIO)
VALUES(60541, 0, 7, '00060541', 4611, 1, 6, '2023-12-14', NULL, NULL, 163.5100, 0.4900, 0.0000, 17.3800, NULL, 100, 267, 246, '164$ en efectivo ', NULL, 0, NULL, 'R', '2023-12-14 18:09:53', 'v0126', NULL, NULL, 'V', '2023-12-14 18:12:25', 2499445, 0, 0.0000)
ON DUPLICATE KEY
UPDATE IDRECIBO = values(IDRECIBO);

select * from dbafv.articulos a  where IDARTICULO =6927;

SELECT * FROM DBAFV.grupo_cliente;

-- ------------------
-- ----- PEDIDOS ----
-- ------------------

-- Consulta (QA FEBECA)
select * from dbafv.orden_lote ol where (OL.NUMORDEN , OL.IDCLIENTE, OL.FECHAEMISION) in (
(60014,15417,'2023-12-08')
);

-- Generar INSERT del registro consultado 
INSERT INTO dbafv.orden_lote
(NUMORDEN, NUMORDEN_ORIGINAL, FECHAEMISION, IDCLIENTE, IDDIRECCION, IDZONAS, IDTIPONEGOCIACION, IDREGLA, HORAINICIA, HORAFINALIZA, IDCANALVENTA, IDCONDICIONVENTA, FECHADESPACHO, NROFACTURA, FECHAEMISIONFACTURA, FECHAVENCIMIENTOFACTURA, COMENTARIOS, ORDENMONTOSINIMPUESTO, ORDENMONTOCONIMPUESTO, ORDENMONTOIMPUESTO, ORDENMONTOSINIMPUESTO_D, ORDENMONTOCONIMPUESTO_D, ORDENMONTOIMPUESTO_D, ID_CAMBIO, TOTALRENGLONES, STATUSREGISTRO, STATUSORDEN, ACTUALIZADO, TIPOENTREGA, FECHATRANSMISION, IDCOLABORADORES, NUMORDENORIGEN, CODIGOUNICO, IDESQUEMAPRECIOS, NUMORDEN_SISTEMA_ORIGEN, IDORIGEN, IDUSUARIO_SISTEMA_ORIGEN, IDINSTRUMENTOPAGO, IDDOCUMENTO, TASA_CAMBIO, SDS_SEQUENCE_ID, IDMONEDA, DESCUENTO_FLETE)
VALUES(60014, 60014, '2023-12-08', 15417, 15417, 318, 63, NULL, '09:39:45', '09:40:27', 6, 1, NULL, NULL, NULL, NULL, '', 128.71, 128.71, 0.00, NULL, NULL, NULL, NULL, 3, 2, 3, NULL, 1, '2023-12-08 09:40:46', 29, NULL, '', 1, 0, 0, 0, 5, NULL, 35.2200, 3871440, 100, 0.00)
ON DUPLICATE KEY
UPDATE NUMORDEN = values(NUMORDEN);



-- ------------------
-- ----- ANEXOS -----
-- ------------------

-- Consulta (PRD BEVAL)
select * from dbafv.anexo a where (a.IDANEXO, a.IDZONA, a.USUARIOCREACION) IN ((60110, 166, 'v0274'));


-- Generar INSERT del registro consultado 
INSERT INTO dbafv.anexo
(IDANEXO, IDCONSECUTIVO, IDCUENTABANCARIA, IDZONA, IDCOLABORADOR, NUMEROANEXO, FECHAEMISIONANEXO, NUMEROPLANILLA, TOTALANEXO, TOTALANEXO_D, TOTALANEXOEDIT, IDMONEDA, STATUSANEXO, STATUSREGISTRO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
VALUES(60110, 0, 8, 166, 151, '27460110', '2023-04-28', '134028841', 3.0000, NULL, NULL, 100, 'V', 'V', '2023-04-28 14:58:32', 'v0274', NULL, NULL, '2023-05-01 23:28:58', 281029, 0)
ON DUPLICATE KEY
UPDATE IDANEXO = values(IDANEXO);




