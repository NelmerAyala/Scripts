
# Consultar Articulos
SELECT ART.IDARTICULO, FECHACREACIONR, 
A.PRECIOLISTA AS PRECIO, A.EXISTENCIA, A.ID_LISTAPRECIO, GC.NOMBRE, ART.CODVIEJO AS CODARTICULO, ART.NOMBRE, A.FECHA_ACTUALIZACION, 
-- M.IDMARCA, M.DESCRIPCION AS MARCA, M.ABREVIADO , 
C.IDMARCA, C.DESCRIPCION AS MARCA_CAT, C.ABREVIADO, UNIDADVENTA_EXHIBICION ,
ART.FECHAACTUALIZACION
FROM DBAFV.ARTICULOS ART
LEFT JOIN DBAFV.ARTICULOS_LPV A ON A.IDARTICULO=ART.IDARTICULO
left join dbafv.grupo_cliente GC on A.ID_LISTAPRECIO = GC.ID_LISTAPRECIO 
-- LEFT JOIN DBAFV.MARCAS M ON M.IDMARCA = ART.IDMARCA  --   WHERE ART.IDARTICULO = 113340 ;
LEFT JOIN DBAFV.MARCACATALOGO C ON C.IDMARCA = ART.IDMARCACATALOGO 
WHERE ART.codviejo IN (
'0631992'
);

INSERT INTO dbafv.retencion
(IDRETENCION, IDCONSECUTIVO, IDMONEDA, IDDOCUMENTO, IDEMISOR, IDRECEPTOR, IDCANALVENTA, IDCOLABORADOR, IDZONA, NUMEROCOMPROBANTE, FECHACOMPROBANTE, FECHAEMISION, FECHAACTUALIZACION, MONTORETENCION, MONTORETENCION_D, ID_CAMBIO, OBSERVACIONES, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, ESTATUSRETENCION, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
values (60265, 0, 100, 10, 15536, 1, 6, 390, 146, '20231200000130', '2023-12-22', '2024-01-18', null, 35.1900, 1254.9317, null, '', '2024-01-18 14:34:57', 'v0612', null, null, 'V', 'V', '2024-01-18 14:36:16', 943550, 0)
ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);



-- consulta de  clientes 088






select * from cliente CL INNER JOIN
    GRUPO_CLIENTE CBP
ON
    CBP.ID_GRUPO_CLIENTE=CL.ID_GRUPO_CLIENTE
WHERE
    CL.IDCLIENTE=1082982; 

select * from dbafv.grupo_cliente;

select * from dbafv.grupos; 

select * from dbafv.pantallasistema; 

select * from dbafv.zonas;

SELECT
    CL.IDCLIENTE,
    CL.IDTIPOCLIENTE,
    CL.IDRAMONEGOCIO,
    CL.IDTIPONEGOCIO,
    CL.IDTIPOSOCIEDAD,
    CL.RIF,
    CL.RAZONSOCIAL,
    CL.NOMBRECOMERCIAL,
    CL.NOMBRESECUNDARIO,
    CL.WEBSITE,
    CL.IDSTATUS,
    CL.FECHAANIVERSARIO,
    CL.CODNEMONICO,
    RD.IDRUTAS,
    RT.NOMBRERUTA,
    (
        SELECT
            IDESQUEMAPRECIOS
        FROM
            RAMONEGOCIO
        WHERE
            IDRAMONEGOCIO=CL.IDRAMONEGOCIO
        AND IDSTATUS=2) AS IDESQUEMAPRECIOS,
    (
        SELECT
            NOMBRERAMONEGOCIO
        FROM
            RAMONEGOCIO
        WHERE
            IDRAMONEGOCIO=CL.IDRAMONEGOCIO
        AND IDSTATUS=2) AS NOMBRERAMONEGOCIO,
    CL.ID_GRUPO_CLIENTE,
    CBP.NOMBRE
FROM
    CLIENTE CL
INNER JOIN
    RUTASDETALLE RD
ON
    RD.IDCLIENTE = CL.IDCLIENTE
INNER JOIN
    RUTAS RT
ON
    RT.IDRUTAS = RD.IDRUTAS
AND RT.IDZONAS = RD.IDZONAS
INNER JOIN
    GRUPO_CLIENTE CBP
ON
    CBP.ID_GRUPO_CLIENTE=CL.ID_GRUPO_CLIENTE
WHERE
    CL.IDCLIENTE=1082982;
   
   
-- ----------------------------------------------------------------------------------------------
-- --------------------------- REPLICACIÃ“N DE AFV-SFL -------------------------------------------
-- ----------------------------------------------------------------------------------------------

-- ------------------
-- --- RETENCIONES --
-- ------------------

-- Consulta
SELECT * from dbafv.retencion r 
where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in ( 
	(60709,37,'v0146')
);

select * from dbafv.retencion R where (R.NUMEROCOMPROBANTE,R.IDEMISOR) IN (
('20230757935814', 7549),
('20230800000044', 11728),
('20231000000057', 11728),
('20231000000056', 11728),
('20231000000063', 11728),
('20231100017264', 1137),
('20231200000072', 11728),
('20231200001452', 20710),
('20231200000208', 22390),
('20231200000000', 1451),
('20240100001066', 8627)
);


INSERT INTO dbafv.retencion
(IDRETENCION, IDCONSECUTIVO, IDMONEDA, IDDOCUMENTO, IDEMISOR, IDRECEPTOR, IDCANALVENTA, IDCOLABORADOR, IDZONA, NUMEROCOMPROBANTE, FECHACOMPROBANTE, FECHAEMISION, FECHAACTUALIZACION, MONTORETENCION, MONTORETENCION_D, ID_CAMBIO, OBSERVACIONES, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, ESTATUSRETENCION, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
VALUES(60709, 0, 100, 10, 1230, 1, 6, 184, 37, '20240100003819', '2024-01-16', '2024-01-29', NULL, 43.3800, 1560.3404, NULL, '', '2024-01-29 10:54:04', 'v0146', NULL, NULL, 'V', 'V', '2024-01-30 05:23:37', 946359, 0)
ON DUPLICATE KEY929904

UPDATE IDRETENCION = values(IDRETENCION);

INSERT INTO dbafv.retencion
(IDRETENCION, IDCONSECUTIVO, IDMONEDA, IDDOCUMENTO, IDEMISOR, IDRECEPTOR, IDCANALVENTA, IDCOLABORADOR, IDZONA, NUMEROCOMPROBANTE, FECHACOMPROBANTE, FECHAEMISION, FECHAACTUALIZACION, MONTORETENCION, MONTORETENCION_D, ID_CAMBIO, OBSERVACIONES, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, ESTATUSRETENCION, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
values
(60410, 0, 100, 10, 8627, 1, 6, 353, 129, '20240100001066', '2024-01-18', '2024-01-19', NULL, 257.4400, 9025.1627, NULL, '', '2024-01-19 14:56:37.0', 'v0019', NULL, NULL, 'V', 'V', '2024-01-19 17:33:08.0', 346658, 0)
ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);

--- --------------------------------------------------------------------



select  * from dbafv.movcomercial m where m.NROMOVFISCAL in (
'06655205',
'06653528',
'06659178',
'06659289',
'06659090',
'06659264',
'06659265',
'06659288',
'06654261',
'06659203',
'06659307',
'06659274',
'06659275',
'06659276',
'06659392',
'06659396',
'06659397',
'06659398',
'06659399',
'06659400',
'06659308',
'06659401',
'06659403',
'06659300',
'06659331',
'06659372',
'06659373'
);

select * from articulos ae where ae.CODVIEJO ='0101A03';

select * from articulos_lpv al where al.IDARTICULO =114849;

select  * from dbafv.transacciones t where t.NUMEROFISCAL in (
'06655205',
'06653528',
'06659178',
'06659289',
'06659090',
'06659264',
'06659265',
'06659288',
'06654261',
'06659203',
'06659307',
'06659274',
'06659275',
'06659276',
'06659392',
'06659396',
'06659397',
'06659398',
'06659399',
'06659400',
'06659308',
'06659401',
'06659403',
'06659300',
'06659331',
'06659372',
'06659373'
)

select  * from dbafv.movcomercialimpuesto m where m.IDMOVCOMERCIAL  in (
723949
)

select  * from dbafv.movcomercialarticulo m where m.IDMOVCOMERCIAL  in (
723949
)


INSERT INTO transacciones 
(IDTRANSACCION_SFL, NUMEROFISCAL, NUMERODOCUMENTOREF, NUMERODOCUMENTO, IDDOCUMENTO, IDDOCUMENTOREF, MONTOALG, MONTOALG_D, NUMERODOCUMENTOREF3, IDDOCUMENTOREF3, ESTATUSDOCUMENTO, IDCANALVENTA, IDZONA, IDCOLABORADOR, IDRECEPTORDOCUMENTO, IDEMISORDOCUMENTO, FECHAEMISION, FECHAVENCIMIENTO, FECHAOPERACION, IDMONEDA, MONTO, SALDO, MONTO_D, SALDO_D, TASA_CAMBIO, NUMERODOCUMENTOREF2, IDDOCUMENTOREF2, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, MONEDATRANSICION, FECHAENTREGA) VALUES (671107,'06643857',671107,671107,1,1,163.76,5906.79,6643857,20,'V',1,389,71,3708,1,'2024-02-26','2024-03-27','2024-02-26',100,163.76,163.76,5906.79,5906.79,36.0698,null,null,'2024-02-26 15:19:33','userAWS','2024-02-26 15:19:33','userAWS','V',0,'2024-02-26');


select  * from dbafv.transacciones t ;

SELECT * FROM TRANSACCIONES WHERE IDTRANSACCION_SFL IN (671076,671074);

SELECT * FROM movcomercialimpuesto m  WHERE m. IN (671076,671074);

select * from logincolaborador l where USERNAME ='v0075';
168

INSERT INTO dbafv.logincolaborador
(IDCOLABORADORES, IDCANALVENTA, USERNAME, PASSWORD, IDSTATUS, SDS_SEQUENCE_ID)
VALUES(168, 6, 'v0075', 'v0075', 2, 102104);




-- ------------------
-- --- RECIBOS ------
-- ------------------
SELECT * from dbafv.recibo r  where (r.IDRECIBO, r.IDZONA, r.USUARIOCREACION) in ( 
(60350, 36, 'v0091')
);

SELECT * from dbafv.recibopago r  where (r.IDRECIBO, r.IDZONA, r.USUARIOCREACION) in ( 
(60223,32,'v0024')
);

SELECT 
        C.IDCLIENTE AS CLIENTE,
        CONCAT(
            'R',
            SUBSTRING(R.USUARIOCREACION, 2),
            SUBSTRING(Z.NOMBREZONA, 2),
            DATE_FORMAT(R.FECHACREACION, '%y%m%d'),
            R.IDRECIBO
        ) AS DOCUMENTO,
        RP.IDENTIDADFINANCIERA AS ENTIDAD_FINANCIERA,
        CONCAT(
            DATE_FORMAT(R.FECHACREACION, '%Y-%m-%dT%T'),
            '.000'
        ) AS U_Fecha_Recibo,
        M.IDMONEDA AS MONEDA,
        CASE
            WHEN RP.IDMONEDA = 205 THEN TRUNCATE(RP.MONTO_OTRAS, 2)
            WHEN RP.IDMONEDA = 100 THEN TRUNCATE(RP.MONTO, 2)
        END AS MONTO,
        TRUNCATE(RP.MONTO, 2) AS MONTO_DOLAR,
        TRUNCATE(RP.MONTO_OTRAS, 2) AS MONTO_LOCAL,
        R.OBSERVACIONES AS NOTAS,
        IP.SUBTIPO AS SUBTIPO,
        IP.TIPO AS TIPO,
        R.IDCOLABORADOR AS VENDEDOR,
        CASE
            WHEN IP.IDINSTRUMENTOPAGO = 21 THEN NULL
            ELSE RP.NUMERODOCUMENTO1
        END AS UDF_PAGO,
        CONCAT(RP.FECHADOCUMENTO, 'T00:00:00.000') AS FECHA_DOCUMENTO,
        CAST(
            CONCAT(
                '[',
                GROUP_CONCAT(
                    DISTINCT JSON_OBJECT(
                        "DEBITO",
                        CASE
                            WHEN MV.USUARIOUA = 'MASIVO_SALDO' THEN CONCAT('A', MV.NROMOVFISCAL)
                            ELSE MV.NROMOVFISCAL
                        END,
                        "CREDITO",
                        CONCAT(
                            'R',
                            SUBSTRING(R.USUARIOCREACION, 2),
                            SUBSTRING(Z.NOMBREZONA, 2),
                            DATE_FORMAT (R.FECHACREACION, '%y%m%d'),
                            RD.IDRECIBO
                        ),
                        "MONTO_DOLAR",
                        RD.MONTOCOBRADO,
                        "MONTO_LOCAL",
                        CASE
                            WHEN RP.IDMONEDA = 100 THEN RD.MONTOCOBRADO_D_ORIG
                            ELSE RD.MONTOCOBRADO_D
                        END,
                        "TIPO_DEBITO",
                        D.TIPO,
                        "TIPO_CREDITO",
                        IP.TIPO,
                        "SUBTIPO_DEBITO",
                        D.SUBTIPO,
                        "SUBTIPO_CREDITO",
                        IP.SUBTIPO,
                        "MONTO_BONIFICACION",
                        RD.MONTOBONIFICACION
                    )
                ),
                ']'
            ) AS JSON
        ) AS reciboDetalle
    FROM recibo R
        INNER JOIN recibopago RP ON (
            R.IDRECIBO = RP.IDRECIBO
            AND R.IDZONA = RP.IDZONA
            AND R.USUARIOCREACION = RP.USUARIOCREACION
        )
        INNER JOIN recibodetalle RD ON (
            RD.IDRECIBO = RP.IDRECIBO
            AND RD.IDZONA = RP.IDZONA
            AND RD.USUARIOCREACION = RP.USUARIOCREACION
        )
        INNER JOIN movcomercial MV ON RD.IDMOVCOMERCIAL = MV.IDMOVCOMERCIAL
        INNER JOIN documentocomercial D ON MV.IDDOCUMENTO = D.IDDOCUMENTO
        INNER JOIN monedas M ON RP.IDMONEDA = M.IDMONEDA
        INNER JOIN cliente C ON R.IDRECEPTORRECIBO = C.IDCLIENTE
        INNER JOIN zonas Z ON R.IDZONA = Z.IDZONAS
        INNER JOIN instrumentopago IP ON RP.IDINSTRUMENTOPAGO = IP.IDINSTRUMENTOPAGO
        -- LEFT JOIN logincolaborador LP ON R.USUARIOCREACION = LP.USERNAME
    WHERE RP.IDCONSECUTIVO = 0
        AND R.USUARIOCREACION = 'v0024'
        AND R.IDZONA = 32
        AND R.IDRECIBO = 60223
    GROUP BY R.IDRECIBO,
        R.IDZONA,
        R.USUARIOCREACION;


INSERT INTO dbafv.recibo
(IDRECIBO, IDCONSECUTIVO, IDDOCUMENTO, NUMERORECIBO, IDRECEPTORRECIBO, IDEMISORRECIBO, IDCANALVENTA, FECHAEMISION, FECHAVENCIMIENTO, FECHAACTUALIZACION, MONTORECIBO, MONTOSOBREPAGO, MONTORECIBO_D, MONTOSOBREPAGO_D, TASA_CAMBIO, IDMONEDA, IDZONA, IDCOLABORADOR, OBSERVACIONES, USUARIOACTUALIZACION, IMPRESIONRECIBO, FECHAIMPRESION, ESTATUSRECIBO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION, DIFERENCIALCAMBIARIO)
VALUES(60223, 0, 7, '00060223', 5053, 1, 6, '2023-12-21', NULL, NULL, 320.0000, 0.0000, 0.0000, 0.0000, NULL, 100, 32, 146, '', NULL, 0, NULL, 'R', '2023-12-21 10:56:06', 'v0024', NULL, NULL, 'V', '2023-12-21 13:25:51', 2502576, 0, 0.0000)
ON DUPLICATE KEY
UPDATE FECHAACTUALIZACION= ('2024-02-16 10:19:00');



-- ------------------
-- ----- PEDIDOS ----
-- ------------------

-- Consulta
select * from dbafv.orden_lote ol where (OL.NUMORDEN , OL.IDCLIENTE) in ((60405,12300));
select * from dbafv.cliente c where c.CODNEMONICO  =2107242;

select * from dbafv.orden_lote ol where (OL.NUMORDEN , OL.IDCLIENTE, OL.FECHAEMISION, ol.IDCOLABORADORES) in (
(60782,8513, '2024-01-10', 225),
(60805,4733, '2024-01-18', 102)
);



INSERT INTO dbafv.orden_lote
(NUMORDEN, NUMORDEN_ORIGINAL, FECHAEMISION, IDCLIENTE, IDDIRECCION, IDZONAS, IDTIPONEGOCIACION, IDREGLA, HORAINICIA, HORAFINALIZA, IDCANALVENTA, IDCONDICIONVENTA, FECHADESPACHO, NROFACTURA, FECHAEMISIONFACTURA, FECHAVENCIMIENTOFACTURA, COMENTARIOS, ORDENMONTOSINIMPUESTO, ORDENMONTOCONIMPUESTO, ORDENMONTOIMPUESTO, ORDENMONTOSINIMPUESTO_D, ORDENMONTOCONIMPUESTO_D, ORDENMONTOIMPUESTO_D, ID_CAMBIO, TOTALRENGLONES, STATUSREGISTRO, STATUSORDEN, ACTUALIZADO, TIPOENTREGA, FECHATRANSMISION, IDCOLABORADORES, NUMORDENORIGEN, CODIGOUNICO, IDESQUEMAPRECIOS, NUMORDEN_SISTEMA_ORIGEN, IDORIGEN, IDUSUARIO_SISTEMA_ORIGEN, IDINSTRUMENTOPAGO, IDDOCUMENTO, TASA_CAMBIO, SDS_SEQUENCE_ID, IDMONEDA, DESCUENTO_FLETE)
VALUES(60805, 60805, '2024-01-18', 4733, 4733, 214, 81, NULL, '12:04:11', '12:04:55', 6, 1, NULL, NULL, NULL, NULL, '', 0.00, 0.00, 0.00, NULL, NULL, NULL, NULL, 0, 2, 4, NULL, 1, '2024-01-18 12:31:02', 102, NULL, '', 1, 0, 0, 0, 23, NULL, 38.4700, 3923487, 100, 0.00)
ON DUPLICATE KEY
UPDATE NUMORDEN = values(NUMORDEN);



-- ------------------
-- ----- ANEXOS -----
-- ------------------

select * from dbafv.anexo a where (a.IDANEXO, a.IDZONA, a.USUARIOCREACION) IN ((60208, 309, 'v0170'));

select  * from dbafv.anexodetalle a where 
(a.IDANEXO, a.IDZONA, a.USUARIOCREACION) IN ((60191, 32, 'v0024'));




IDANEXO=
IDZONA=
USUARIOCREACION=''
FECHACREACION=2024-02-02

select * from colaboradores c where c.NOMBRE1COLABORADOR like '%YELITZA GIRALDO%';
249

select * from logincolaborador l where IDCOLABORADORES =249;

select * from dbafv.anexo a
where (a.IDANEXO  , a.USUARIOCREACION) IN ((60011, 'v0075'));

INSERT INTO dbafv.anexo
(IDANEXO, IDCONSECUTIVO, IDCUENTABANCARIA, IDZONA, IDCOLABORADOR, NUMEROANEXO, FECHAEMISIONANEXO, NUMEROPLANILLA, TOTALANEXO, TOTALANEXO_D, TOTALANEXOEDIT, IDMONEDA, STATUSANEXO, STATUSREGISTRO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
VALUES(60208, 0, 11, 309, 170, '17060208', '2024-02-02', '6012824', 200.0000, NULL, NULL, 100, 'V', 'V', '2024-02-02 16:57:38', 'v0170', NULL, NULL, '2024-02-02 16:58:19', 343115, 0)
ON DUPLICATE KEY UPDATE IDANEXO = values(IDANEXO);


-- ----------------------------------------------------------------------------------------------
-- --------------------------- REPLICACIÃ“N DE AFV-SFL -------------------------------------------
-- ----------------------------------------------------------------------------------------------

-- ----------------------------------------------------------------------------------------------
-- CONSULTAS EN DOCUMENTOS COMERCIALES
-- ----------------------------------------------------------------------------------------------

FROM (
  VALUES 
('RET014614624012960709')
) AS RET(RETENCION) left join SOFTLANDPRD.FEBECA.DOCUMENTOS_CC dc on RET.RETENCION=dc.DOCUMENTO;

select RET.CODIGO, m.NROMOVFISCAL from  
(
values (
('669046'),
('673580'),
('680170'),
('669113'),
('672270'),
('673469'),
('659059'),
('674095'),
('660274'),
('680230'),
('682141'),
('673528'),
('672928'),
('676241'),
('681159'),
('678418'),
('681727')
) ) as RET(CODIGO) right join movcomercial m on RET.CODIGO = m.IDMOVCOMERCIAL 
where m.IDMOVCOMERCIAL  in (
'669046',
'673580',
'680170',
'669113',
'672270',
'673469',
'659059',
'674095',
'660274',
'680230',
'682141',
'673528',
'672928',
'676241',
'681159',
'678418',
'681727'
) ;

select * from movcomercial m where m.IDMOVCOMERCIAL in (
'678418'
);

select * from movcomercial m where m.IDMOVCOMERCIAL in (
680170,
680230,
681865,
681866,
681867,
681851);


select * from transacciones t where t.IDTRANSACCION_SFL  in (
680170,
680230,
681865,
681866,
681867,
681851
);

select * from movcomercialimpuesto m 
where m.IDMOVCOMERCIAL in (
680170,
680230,
681865,
681866,
681867,
681851
);


select  distinct IDMOVCOMERCIAL  from movcomercialarticulo m 
where m.IDMOVCOMERCIAL in (
680170,
680230,
681865,
681866,
681867,
681851);



insert

	into
	dbafv.retencion (IDRETENCION,
	IDCONSECUTIVO,
	IDMONEDA,
	IDDOCUMENTO,
	IDEMISOR,
	IDRECEPTOR,
	IDCANALVENTA,
	IDCOLABORADOR,
	IDZONA,
	NUMEROCOMPROBANTE,
	FECHACOMPROBANTE,
	FECHAEMISION,
	FECHAACTUALIZACION,
	MONTORETENCION,
	MONTORETENCION_D,
	ID_CAMBIO,
	OBSERVACIONES,
	FECHACREACION,
	USUARIOCREACION,
	FECHAUA,
	USUARIOUA,
	ESTATUSREGISTRO,
	ESTATUSRETENCION,
	FECHATRANSMISION,
	SDS_SEQUENCE_ID,
	MONEDATRANSICION)
values (60195,
now(),
0,
100,
10,
989,
1,
6,
19,
140,
'20230957940633',
'2023-09-15',
'2024-01-18',
null,
631.0100,
19898.8700,
null,
'',
'2024-01-18 11:38:44',
'v0890',
null,
null,
'V',
'V',
'2024-01-18 11:39:01',
943489,
0) on
DUPLICATE key
update
	FECHAACTUALIZACION =
values(FECHAACTUALIZACION);


#----------------- CONSULTA PARA VISUALIZAR CLIENTE EN AFV ----------------------------
# Si no aparece el cliente es porque le hace falta alguna informaciÃ³n en alguna de estas tablas
SELECT * FROM DBAFV.CLIENTE C 
INNER JOIN DBAFV.GRUPO_CLIENTE G ON C.ID_GRUPO_CLIENTE=G.ID_GRUPO_CLIENTE
INNER JOIN DBAFV.CLIENTEZONA CZ ON CZ.IDCLIENTE=C.IDCLIENTE
INNER JOIN DBAFV.RUTASDETALLE R ON R.IDCLIENTE=C.IDCLIENTE AND R.IDZONAS = CZ.IDZONAs
INNER JOIN DBAFV.RUTAS RU ON RU.IDRUTAS = R.IDRUTAS AND RU.IDZONAS = R.IDZONAS 
INNER JOIN DBAFV.CLIENTEDIRECCION CD ON CD.IDCLIENTE=C.IDCLIENTE
INNER JOIN DBAFV.cyc_clienterepresentante CR ON CR.IDCLIENTE=C.IDCLIENTE
INNER JOIN DBAFV.cyc_clientetelefonos CT ON CT.IDCLIENTE=C.IDCLIENTE
INNER JOIN DBAFV.cyc_conceptotributariocliente CTB ON CTB.IDCLIENTE=C.IDCLIENTE
INNER JOIN DBAFV.cyc_limitedecredito CL ON CL.IDCLIENTE=C.IDCLIENTE
WHERE  C.idcliente IN (SELECT idcliente from dbafv.cliente where codnemonico IN('4573049') );


# ------------- Consultar pedido y armar concatenado del mismo
# ------------- Con: NumOrden y CODNEMONICO
SELECT
    C.IDCLIENTE AS CLIENTE,
    C.IDCATEGORIA AS CONDICION_PAGO,
    CASE
        WHEN O.STATUSORDEN = 3 THEN 'N'
        WHEN O.STATUSORDEN = 4 THEN 'A'
    END AS ESTADO,
    CONCAT(O.FECHAEMISION, 'T', O.HORAFINALIZA, '.000') AS FECHA_HORA,
    O.COMENTARIOS AS OBSERVACIONES,
    CONCAT(
        'P',
        SUBSTRING(LC.USERNAME, 2),
        SUBSTRING(Z.CODIGOZONA, 2),
        SUBSTRING(DATE_FORMAT(O.FECHAEMISION, '%Y%m%d'), 3),
        O.NUMORDEN
    ) AS PEDIDO,
    O.DESCUENTO_FLETE AS PORC_DESCUENTO1,
    RD.IDRUTAS AS RUTA,
    O.IDCOLABORADORES AS VENDEDOR,
    CONCAT(
        'P',
        SUBSTRING(LC.USERNAME, 2),
        SUBSTRING(Z.CODIGOZONA, 2),
        SUBSTRING(DATE_FORMAT(O.FECHAEMISION, '%Y%m%d'), 3),
        O.NUMORDEN_ORIGINAL
    ) AS U_Pedido_Padre,
    O.IDINSTRUMENTOPAGO AS U_Instrumento_Pago,
    I.NOMBRECORTO AS U_Descripcion,
    CASE
        WHEN O.IDORIGEN = 100 THEN 'S'
        ELSE 'N'
    END AS U_ORIGENCATALOGO
FROM
    orden_lote O
    INNER JOIN cliente C ON O.IDCLIENTE = C.IDCLIENTE
    INNER JOIN rutasdetalle RD ON O.IDCLIENTE = RD.IDCLIENTE
    INNER JOIN instrumentopago I ON O.IDINSTRUMENTOPAGO = I.IDINSTRUMENTOPAGO
    INNER JOIN zonas Z ON O.IDZONAS = Z.IDZONAS
    INNER JOIN logincolaborador LC ON LC.IDCOLABORADORES = O.IDCOLABORADORES
WHERE (O.NUMORDEN, C.CODNEMONICO) in ((60454, '6101284'));

# ------------- Con: NumOrden y idcliente 
SELECT
    C.IDCLIENTE AS CLIENTE,
    C.IDCATEGORIA AS CONDICION_PAGO,
    CASE
        WHEN O.STATUSORDEN = 3 THEN 'N'
        WHEN O.STATUSORDEN = 4 THEN 'A'
    END AS ESTADO,
    CONCAT(O.FECHAEMISION, 'T', O.HORAFINALIZA, '.000') AS FECHA_HORA,
    O.COMENTARIOS AS OBSERVACIONES,
    CONCAT(
        'P',
        SUBSTRING(LC.USERNAME, 2),
        SUBSTRING(Z.CODIGOZONA, 2),
        SUBSTRING(DATE_FORMAT(O.FECHAEMISION, '%Y%m%d'), 3),
        O.NUMORDEN
    ) AS PEDIDO,
    O.DESCUENTO_FLETE AS PORC_DESCUENTO1,
    RD.IDRUTAS AS RUTA,
    O.IDCOLABORADORES AS VENDEDOR,
    CONCAT(
        'P',
        SUBSTRING(LC.USERNAME, 2),
        SUBSTRING(Z.CODIGOZONA, 2),
        SUBSTRING(DATE_FORMAT(O.FECHAEMISION, '%Y%m%d'), 3),
        O.NUMORDEN_ORIGINAL
    ) AS U_Pedido_Padre,
    O.IDINSTRUMENTOPAGO AS U_Instrumento_Pago,
    I.NOMBRECORTO AS U_Descripcion,
    CASE
        WHEN O.IDORIGEN = 100 THEN 'S'
        ELSE 'N'
    END AS U_ORIGENCATALOGO
FROM
    orden_lote O
    INNER JOIN cliente C ON O.IDCLIENTE = C.IDCLIENTE
    INNER JOIN rutasdetalle RD ON O.IDCLIENTE = RD.IDCLIENTE
    INNER JOIN instrumentopago I ON O.IDINSTRUMENTOPAGO = I.IDINSTRUMENTOPAGO
    INNER JOIN zonas Z ON O.IDZONAS = Z.IDZONAS
    INNER JOIN logincolaborador LC ON LC.IDCOLABORADORES = O.IDCOLABORADORES
WHERE (O.NUMORDEN, C.IDCLIENTE) in ((60454, '15414'));



-- ---------------------------------------------------------------
-- ------------- Consultas de Recibos ----------------------------   
-- ---------------------------------------------------------------
# Armar tuplas para generar otras consultas
SELECT concat("(",r.IDRECIBO,",", r.IDZONA,",'", r.USUARIOCREACION,"'),") from dbafv.recibo r  where FECHACREACION >= '2024-01-19';

# ----------- RECIBOS CONCILIADOS LAMBDA DM RECIBOS
# TODOS los datos necesarios aquÃ­ los obtengo de la DB CONCILIATE consiguiendo el documento
SELECT
        C.IDCLIENTE AS CLIENTE,
        CONCAT(
            'R',
            SUBSTRING(R.USUARIOCREACION, 2),
            SUBSTRING(Z.NOMBREZONA, 2),
            DATE_FORMAT(R.FECHACREACION, '%y%m%d'),
            R.IDRECIBO
        ) AS DOCUMENTO,
        CU.IDENTIDADFINANCIERA AS ENTIDAD_FINANCIERA,
        CONCAT(
            DATE_FORMAT(R.FECHACREACION, '%Y-%m-%dT%T'),
            '.000'
        ) AS U_Fecha_Recibo,
        CU.IDTIPOCUENTABANCARIA AS MONEDA,
        CASE
            WHEN RP.IDMONEDA = 205 THEN TRUNCATE(RP.MONTO_OTRAS, 2)
            WHEN RP.IDMONEDA = 100 THEN TRUNCATE(RP.MONTO, 2)
        END AS MONTO,
        TRUNCATE(RP.MONTO, 2) AS MONTO_DOLAR,
        TRUNCATE(RP.MONTO_OTRAS, 2) AS MONTO_LOCAL,
        R.OBSERVACIONES AS NOTAS,
        IP.SUBTIPO AS SUBTIPO,
        IP.TIPO AS TIPO,
        CB.IDCOLABORADORES AS VENDEDOR,
        CASE
            WHEN IP.IDINSTRUMENTOPAGO = 21 THEN NULL
            ELSE RP.NUMERODOCUMENTO1
        END AS UDF_PAGO,
        CONCAT(RP.FECHADOCUMENTO, 'T00:00:00.000') AS FECHA_DOCUMENTO,
        CAST(
            CONCAT(
                '[',
                GROUP_CONCAT(
                    DISTINCT JSON_OBJECT(
                        "DEBITO",
                        CASE
                            WHEN MV.USUARIOUA = 'MASIVO_SALDO' THEN CONCAT('A', MV.NROMOVFISCAL)
                            ELSE MV.NROMOVFISCAL
                        END,
                        "CREDITO",
                        CONCAT(
                            'R',
                            SUBSTRING(R.USUARIOCREACION, 2),
                            SUBSTRING(Z.NOMBREZONA, 2),
                            DATE_FORMAT (R.FECHACREACION, '%y%m%d'),
                            RD.IDRECIBO
                        ),
                        "MONTO_DOLAR",
                        RD.MONTOCOBRADO,
                        "MONTO_LOCAL",
                        CASE
                            WHEN RP.IDMONEDA = 100 THEN RD.MONTOCOBRADO_D_ORIG
                            ELSE RD.MONTOCOBRADO_D
                        END,
                        "TIPO_DEBITO",
                        D.TIPO,
                        "TIPO_CREDITO",
                        IP.TIPO,
                        "SUBTIPO_DEBITO",
                        D.SUBTIPO,
                        "SUBTIPO_CREDITO",
                        IP.SUBTIPO,
                        "MONTO_BONIFICACION",
                        RD.MONTOBONIFICACION
                    )
                ),
                ']'
            ) AS JSON
        ) AS reciboDetalle
    FROM recibo R
        INNER JOIN recibopago RP ON (
            R.IDRECIBO = RP.IDRECIBO
            AND R.IDZONA = RP.IDZONA
            AND R.USUARIOCREACION = RP.USUARIOCREACION
        )
        INNER JOIN recibodetalle RD ON (
            RD.IDRECIBO = RP.IDRECIBO
            AND RD.IDZONA = RP.IDZONA
            AND RD.USUARIOCREACION = RP.USUARIOCREACION
        )
        INNER JOIN movcomercial MV ON RD.IDMOVCOMERCIAL = MV.IDMOVCOMERCIAL
        INNER JOIN documentocomercial D ON MV.IDDOCUMENTO = D.IDDOCUMENTO
        INNER JOIN monedas M ON RP.IDMONEDA = M.IDMONEDA
        INNER JOIN cliente C ON R.IDRECEPTORRECIBO = C.IDCLIENTE
        INNER JOIN zonas Z ON R.IDZONA = Z.IDZONAS
        LEFT JOIN colaboradores CB ON R.IDCOLABORADOR = CB.IDCOLABORADORES
        INNER JOIN instrumentopago IP ON RP.IDINSTRUMENTOPAGO = IP.IDINSTRUMENTOPAGO
        INNER JOIN cuentabancariainterna CU
    WHERE 
    -- RP.IDCONSECUTIVO = 0
     --   AND R.USUARIOCREACION = 'v0027'
     --   AND R.IDZONA = 78
     --   AND R.IDRECIBO = 60130
     --   AND CU.IDCUENTABANCARIA = 1
      (R.IDRECIBO,R.IDZONA, R.USUARIOCREACION  )
       in (
(60727,58,'v0061')
)
    GROUP BY R.IDRECIBO,
        R.IDZONA,
        R.USUARIOCREACION;
       
       
SELECT * from dbafv.retencion r  where (r.IDRETENCION, r.USUARIOCREACION) in ( 
(60001,'v0120')
);

 where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in ( 
(60001,261,'v0120')
);


INSERT INTO dbafv.retencion
(IDRETENCION, IDCONSECUTIVO, IDMONEDA, IDDOCUMENTO, IDEMISOR, IDRECEPTOR, IDCANALVENTA, IDCOLABORADOR, IDZONA, TIPO, NUMEROCOMPROBANTE, FECHACOMPROBANTE, FECHAEMISION, FECHAACTUALIZACION, MONTORETENCION, MONTORETENCION_D, ID_CAMBIO, OBSERVACIONES, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, ESTATUSRETENCION, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION)
VALUES(60001, 0, 100, 10, 26358, 1, 6, 17, 22, NULL, '20230100000223', '2023-01-12', '2023-01-19', NULL, 29.5200, 552.1500, NULL, '', '2023-01-19 12:18:47', 'v0120', NULL, NULL, 'V', 'V', '2023-01-19 12:19:00', 936856, 0)
ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);


select *
from dbafv.movcomercial m 
where SALDO > 0;

SELECT EXISTENCIA FROM DBAFV.ARTICULOS_LPV A WHERE A.IDARTICULO=108763; 
	

SELECT 
	ART.CODVIEJO, art.*
FROM 
	dbafv.articulos art
where 
	art.CODVIEJO in ()
	
	and m.ABREVIADO != '%NVD%'
	
	
	and
	#artlpv.EXISTENCIA > 0 and
	# GC.NOMBRE like '%MAYOREOD%' AND	
	#m.ABREVIADO != '%NVD%'

	
/*Obtener documentos por numero de factura*/
SELECT * FROM MOVCOMERCIAL WHERE NROMOVFISCAL IN ('06651040');

# Si estÃ¡ en 0 no se en AFV
SELECT * FROM TRANSACCIONES WHERE NUMEROFISCAL IN ('06651040') and saldo > 0;

SELECT *  FROM TRANSACCIONES WHERE NUMEROFISCAL  =03252761;

select * from orden_lote ol where OL.NUMORDEN ='60100';

/*Obtener documentos por ID*/
SELECT * FROM MOVCOMERCIAL WHERE NROMOVFISCAL IN (06621633);

SELECT * FROM MOVCOMERCIALIMPUESTO WHERE IDMOVCOMERCIAL IN (693952);
SELECT * FROM MOVCOMERCIALARTICULO WHERE IDMOVCOMERCIAL IN (693952);

select * from cliente c where c.IDCLIENTE = 17793;

select * from cliente c where c.RAZONSOCIAL like '%Jose Estrella%'




select * from clientezona c where C.IDCLIENTE =2943

select * from zonas z where z.NOMBREZONA ='Z077'


select * from rutas r where IDRUTAS =20 and IDZONAS =340;
SELECT * from dbafv.rutas r where r.idzonas=91;
SELECT * from dbafv.rutasDETALLE r where r.idzonas=91;
SELECT * from dbafv.CLIENTEZONA r where r.idzonas=91;

/*Obtener documentos por ID_CLIENTE*/
SELECT * FROM MOVCOMERCIAL WHERE IDRECEPTORMOVIMIENTO = 2187;
SELECT * FROM TRANSACCIONES WHERE IDRECEPTORDOCUMENTO = 2187;

/*Obtener documentos por codigo de cliente*/
SELECT * FROM MOVCOMERCIAL MOV LEFT JOIN CLIENTE C ON MOV.IDRECEPTORMOVIMIENTO = C.IDCLIENTE WHERE C.CODNEMONICO = '8118128';
SELECT * FROM TRANSACCIONES T LEFT JOIN CLIENTE C ON T.IDRECEPTORDOCUMENTO = C.IDCLIENTE WHERE C.CODNEMONICO = '8118128';

/*Tipos y Subtipos de AFV*/
SELECT tipo, subtipo, nombrecorto, iddocumento FROM DOCUMENTOCOMERCIAL where TIPO is not null;

/*Estatus de encendido de Cotizacion*/
/*SELECT * FROM PARAMAPP WHERE CODPAR='ENABCOTI';*/
/*Encender Cotizacion*/
/*UPDATE DBAFV.PARAMAPP SET VALCAD='1' WHERE CODPAR='ENABCOTI';*/
/*Apagar Cotizacion*/
/*UPDATE DBAFV.PARAMAPP SET VALCAD='0' WHERE CODPAR='ENABCOTI';*/


SELECT * FROM dbafv.recibo r inner join zonas z on r.IDZONA = z.IDZONAS where r.NUMERORECIBO  = '00060144' and z.NOMBREZONA ='Z077' ;
SELECT * FROM dbafv.recibo r inner join zonas z on r.IDZONA = z.IDZONAS where r.NUMERORECIBO  = '00060145' and z.NOMBREZONA ='Z077' ;
SELECT * FROM dbafv.recibo r inner join zonas z on r.IDZONA = z.IDZONAS where r.NUMERORECIBO  = '00060146' and z.NOMBREZONA ='Z077' ;


SELECT 
	z.NOMBREZONA, c.NOMBRE1COLABORADOR, c.NOMBRE2COLABORADOR, cli.RAZONSOCIAL, r.*
FROM 
	dbafv.recibo r 
	inner join dbafv.zonas z on r.IDZONA = z.IDZONAS 
	inner join dbafv.colaboradores c on r.IDCOLABORADOR =c.IDCOLABORADORES
	inner join dbafv.cliente cli on r.IDRECEPTORRECIBO = cli.IDCLIENTE 
where 
	r.NUMERORECIBO like '60072'
	and (cli.CODNEMONICO ='4553007' or cli.RAZONSOCIAL like '%4553007%')
	
	and z.NOMBREZONA='z091'
	
	and (c.NOMBRE1COLABORADOR  like '%ALEXANDER CASTILLO (S)%' or c.NOMBRE2COLABORADOR like '%ALEXANDER CASTILLO (S)%')
	
	
SELECT 
	a.*
FROM 
	dbafv.anexo a
where 	
	#a.NUMEROANEXO like '%1656007%' 
	#and
	a.NUMEROANEXO ='60071'
	#and IDCLIENTE =6330
	#and IDCLIENTE =14125
	
	
SELECT 
	m.*
FROM 
	dbafv.movcomercial m 
where
	m.IDMOVCOMERCIAL =527837
	and (cli.CODNEMONICO ='4553007' or cli.RAZONSOCIAL like '%4553007%')
	
	
	
select * from dbafv.cliente c 
where c.RAZONSOCIAL like '%VARIEDADES C.K.G%'
IDCLIENTE: 21526
CODNEMONICO: 2667238


	(CODNEMONICO ='4545014' 
	or RAZONSOCIAL like '%4545014%')
	
select * from dbafv.cliente c 
where 
	(CODNEMONICO ='4553007' 
	or RAZONSOCIAL like '%4553007%')
	
select * from dbafv.cliente c 
where 
	(CODNEMONICO ='4565060' 
	or RAZONSOCIAL like '%4565060%')

	
select * from dbafv.zonas z where z.NOMBREZONA = 'Z181' or z.IDZONAS = 299

select * from dbafv.colaboradores c where nombre1colaborador like '%AGUIRRE%'

where IDCOLABORADORES ='294'

select * from dbafv.logincolaborador where IDCOLABORADORES  ='119'


'33-18-052','81-41-895'


select * from dbafv.movcomercialarticulo m  where M.IDMOVCOMERCIALARTICULO  IN (693150,693014, 693150)

select * from dbafv.clientezona c 

select 
*
#cz.IDZONA 
#	distinct c.IDCLIENTE, efr.EXT_FREIGHTRULE_ID, c.CODNEMONICO
from 
	dbafv.cliente c 
	inner join dbafv.clientedireccion c2 on c.IDCLIENTE = c2.IDCLIENTE 
	inner join dbafv.clientezona cz on c.IDCLIENTE =cz.IDCLIENTE 
	inner join dbafv.zonas z on cz.IDZONAS =z.IDZONAS 
	inner join dbafv.grupo_cliente gc on gc.ID_GRUPO_CLIENTE = c.ID_GRUPO_CLIENTE 
	#inner join dbafv.ext_freightrule efr on c2.IDDIRECCION = efr.EXT_FREIGHTRULE_ID
where 
	CODNEMONICO ='3318052'
	
	'33-18-052','8141895'
	c.IDCLIENTE ='32450'

	select 
*
#cz.IDZONA 
#	distinct c.IDCLIENTE, efr.EXT_FREIGHTRULE_ID, c.CODNEMONICO
from 
	#dbafv.cliente c 
	#left join 
	dbafv.clientedireccion
	#left join 
	#dbafv.clientezona cz
	#left join dbafv.zonas z on cz.IDZONAS =z.IDZONAS 
	#dbafv.grupo_cliente gc on gc.ID_GRUPO_CLIENTE = c.ID_GRUPO_CLIENTE 
	#inner join dbafv.ext_freightrule efr on c2.IDDIRECCION = efr.EXT_FREIGHTRULE_ID
where 
	IDCLIENTE in (11847,14208)
	
	
select #c.ID_REGLADESCUENTO, cz.IDZONA 
	distinct c.IDCLIENTE, c.CODNEMONICO, c.FECHAREGISTRO 
from 
	dbafv.cliente c 
	inner join dbafv.clientedireccion c2 on c.IDCLIENTE = c2.IDCLIENTE 
	inner join dbafv.clientezona cz on c.IDCLIENTE =cz.IDCLIENTE 
	inner join dbafv.zonas z on cz.IDZONAS =z.IDZONAS 
where 
	#CODNEMONICO ='1941191'
	c.IDCLIENTE ='32450'

	

# Cliente sin regla de felete
# Bueno 
IDCLIENTE ='32309'
CODNEMONICO = 8196162
# Mal
IDCLIENTE ='32450'
CODNEMONICO = 1941191


select *
from 
	dbafv.cliente c 
where CODNEMONICO ='1941191'

idclient = 32450	
idzonas = 253

select *
from ramonegocio r 


select *
from tipocliente t 


select * 
from 
	dbafv.regla_descuento_detalle
where ID_REGLADESCUENTO= 1

select * 
from 
	dbafv.regla_descuento rd
where ID_REGLADESCUENTO= 1


select * 
from 
	dbafv.ext_freightcircularline efcl

select * 
from 
	dbafv.ext_freightcircular efc

select * 
from 
	dbafv.ext_freightelement efe


select * 
from 
	dbafv.ext_freightrule ef 
where ef.EXT_FREIGHTRULE_ID ='32450'

select count(date_format(ef.CREATED, '%Y-%m-%d' )), date_format(ef.CREATED, '%Y-%m-%d' )
from 
	dbafv.ext_freightrule ef 
where ef.CREATED like '%2023-10-26%'
group by date_format(ef.CREATED, '%Y-%m-%d' )


select *
from 
	dbafv.ext_freightrule ef 
where ef.CREATED like '%2023-10-26%'

select distinct ef.CREATED 
from 
	dbafv.ext_freightrule ef 


4545014

71 al 78


select * 
from dbafv.cliente c 
where C.CODNEMONICO = '2692001' 


and IDZONA =25

60250
707824

select * 
from dbafv.anexo a  
where A.IDANEXO  like '60198' and IDZONA =25 and co



select * 
from dbafv.anexo a
where a.IDANEXO =60110



SELECT C.IDCLIENTE AS CLIENTE,
CONCAT(
'R',
SUBSTRING(LP.USERNAME, 2),
SUBSTRING(Z.NOMBREZONA, 2),
DATE_FORMAT(R.FECHACREACION, '%y%m%d'),
R.IDRECIBO
) AS DOCUMENTO,
RP.IDENTIDADFINANCIERA AS ENTIDAD_FINANCIERA,
CONCAT(
DATE_FORMAT(R.FECHACREACION, '%Y-%m-%dT%T'),
'.000'
) AS U_Fecha_Recibo,
M.IDMONEDA AS MONEDA,
CASE
WHEN RP.IDMONEDA = 205 THEN TRUNCATE(RP.MONTO_OTRAS, 2)
WHEN RP.IDMONEDA = 100 THEN TRUNCATE(RP.MONTO, 2)
END AS MONTO,
TRUNCATE(RP.MONTO, 2) AS MONTO_DOLAR,
TRUNCATE(RP.MONTO_OTRAS, 2) AS MONTO_LOCAL,
R.OBSERVACIONES AS NOTAS,
IP.SUBTIPO AS SUBTIPO,
IP.TIPO AS TIPO,
CB.IDCOLABORADORES AS VENDEDOR,
CASE
WHEN IP.IDINSTRUMENTOPAGO = 21 THEN NULL
ELSE RP.NUMERODOCUMENTO1
END AS UDF_PAGO,
CONCAT(RP.FECHADOCUMENTO, 'T00:00:00.000') AS FECHA_DOCUMENTO,
CAST(
CONCAT(
'[',
GROUP_CONCAT(
DISTINCT JSON_OBJECT(
"DEBITO",
CASE
WHEN MV.USUARIOUA = 'MASIVO_SALDO' THEN CONCAT('A-', MV.NROMOVFISCAL)
ELSE MV.NROMOVFISCAL
END,
"CREDITO",
CONCAT(
'R',
SUBSTRING(LP.USERNAME, 2),
SUBSTRING(Z.NOMBREZONA, 2),
DATE_FORMAT (RD.FECHACREACION, '%y%m%d'),
RD.IDRECIBO
),
"MONTO_DOLAR",
RD.MONTOCOBRADO,
"MONTO_LOCAL",
CASE
WHEN RP.IDMONEDA = 100 THEN RD.MONTOCOBRADO_D_ORIG
ELSE RD.MONTOCOBRADO_D
END,
"TIPO_DEBITO",
D.TIPO,
"TIPO_CREDITO",
IP.TIPO,
"SUBTIPO_DEBITO",
D.SUBTIPO,
"SUBTIPO_CREDITO",
IP.SUBTIPO,
"MONTO_BONIFICACION",
RD.MONTOBONIFICACION
)
),
']'
) AS JSON
) AS reciboDetalle
FROM recibo R
INNER JOIN recibopago RP ON (
R.IDRECIBO = RP.IDRECIBO
AND R.IDZONA = RP.IDZONA
AND R.USUARIOCREACION = RP.USUARIOCREACION
)
INNER JOIN recibodetalle RD ON (
RD.IDRECIBO = RP.IDRECIBO
AND RD.IDZONA = RP.IDZONA
AND RD.USUARIOCREACION = RP.USUARIOCREACION
)
INNER JOIN movcomercial MV ON RD.IDMOVCOMERCIAL = MV.IDMOVCOMERCIAL
INNER JOIN documentocomercial D ON MV.IDDOCUMENTO = D.IDDOCUMENTO
INNER JOIN monedas M ON RP.IDMONEDA = M.IDMONEDA
INNER JOIN cliente C ON R.IDRECEPTORRECIBO = C.IDCLIENTE
INNER JOIN zonas Z ON R.IDZONA = Z.IDZONAS
INNER JOIN colaboradores CB ON R.IDCOLABORADOR = CB.IDCOLABORADORES
INNER JOIN instrumentopago IP ON RP.IDINSTRUMENTOPAGO = IP.IDINSTRUMENTOPAGO
INNER JOIN logincolaborador LP ON R.USUARIOCREACION = LP.USERNAME
# WHERE R.IDRECIBO IN (60163 )
# AND C.CODNEMONICO = '4545014'
WHERE R.IDRECIBO IN (60139  )
AND C.CODNEMONICO = '7364009'
GROUP BY R.IDRECIBO,
R.IDZONA,
R.USUARIOCREACION;

(60139,347,'v0034')
	363	v0064

	select * from dbafv.cliente c where c.IDCLIENTE =2822;
select *
from rutas r 
where IDRUTAS in (63, 65, 53) and IDZONAS in (355, 153, 203)




SELECT
ANEXO.IDANEXO AS id_documento_afv,
ANEXO.USUARIOCREACION AS USUARIO_CREACION,
ANEXO.IDZONA AS ID_ZONA,
ZONAS.NOMBREZONA AS NOMBRE_ZONA,
COLABORADORES.NOMBRE1COLABORADOR AS VENDEDOR,
ANEXO.FECHAEMISIONANEXO AS FECHA_DOCUMENTO,
ANEXO.NUMEROPLANILLA AS REFERENCIA,
ENTIDADFINANCIERA.NOMBRECORTO AS BANCO,
CUENTABANCARIAINTERNA.NUMEROCUENTABANCARIA AS NUMERO_CUENTA_BANCARIA,
ANEXO.IDMONEDA AS ID_MONEDA,
anexo .IDCUENTABANCARIA as ID_CUENTA_BANCARIA,
MONEDAS.ABREVIACION AS MONEDA,
anexo.TOTALANEXO as monto,
CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('ID', CLIENTE.IDCLIENTE,'CODIGO_DE_CLIENTE',CLIENTE.CODNEMONICO,'RIF_CLIENTE', CLIENTE.RIF,'RAZON_SOCIAL_CLIENTE',CLIENTE.RAZONSOCIAL ) ), ']') AS JSON) AS CLIENTES,
CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('DOCUMENTO', ANEXODETALLE.IDRECIBOPAGO,'MONTO', CAST( ANEXODETALLE.MONTO AS CHAR),'MONTO_EDITADO', CAST(ANEXODETALLE.MONTO_D AS CHAR) ) ), ']') AS JSON) AS DOCUMENTOS_ASOCIADOS
FROM ANEXO
INNER JOIN ANEXODETALLE AS ANEXODETALLE ON ANEXO.IDANEXO = ANEXODETALLE.IDANEXO AND ANEXO.IDZONA = ANEXODETALLE.IDZONA AND ANEXO.USUARIOCREACION = ANEXODETALLE.USUARIOCREACION
LEFT JOIN COLABORADORES ON ANEXO.IDCOLABORADOR = COLABORADORES.IDCOLABORADORES
LEFT JOIN ZONAS AS ZONAS ON ANEXO.IDZONA = ZONAS.IDZONAS
LEFT JOIN CUENTABANCARIAINTERNA AS CUENTABANCARIAINTERNA ON ANEXO.IDCUENTABANCARIA = CUENTABANCARIAINTERNA.IDCUENTABANCARIA
LEFT JOIN ENTIDADFINANCIERA AS ENTIDADFINANCIERA ON CUENTABANCARIAINTERNA.IDENTIDADFINANCIERA = ENTIDADFINANCIERA.IDENTIDADFINANCIERA
LEFT JOIN MONEDAS AS MONEDAS ON MONEDAS.IDMONEDA = ANEXO.IDMONEDA
LEFT JOIN CLIENTE ON ANEXODETALLE.IDCLIENTE = CLIENTE.IDCLIENTE
	WHERE
	(ANEXO.IDANEXO,ANEXO.IDZONA, ANEXO.USUARIOCREACION) IN ((60110, 166, 'v0274'))
GROUP BY ANEXO.IDANEXO, ANEXO.IDZONA,ANEXO.USUARIOCREACION;




SELECT * FROM DBAFV.TRANSACCIONES M WHERE M.NUMERODOCUMENTOREF IN (19256,19257) AND IDDOCUMENTO=10;

60040



select * from dbafv.recibo r 
where r.IDRECIBO  ='60537' and r.IDZONA =66 and r.USUARIOCREACION ='v0073'



SELECT * FROM DBAFV.TRANSACCIONES M WHERE M.NUMERODOCUMENTOREF IN (380937) AND IDDOCUMENTO=10;

select *
from dbafv.promocioncabecera p 
inner join dbafv.promociondetalle p2 on P.IDPROMOCION = P2.IDPROMOCION 


select *
from dbafv.promocioncabecera p 
inner join dbafv.promociondetalle p2 on P.IDPROMOCION = P2.IDPROMOCION 
where P2.IDARTICULO = 1067002


select * from dbafv.EX


## ----- concatenado de retencion


select CONCAT("(", R.IDRETENCION ,",",r.IDZONA ,",'", r.USUARIOCREACION,"'),")
from dbafv.retencion r 
where r.IDCOLABORADOR =138 and FECHACOMPROBANTE >='2023-10-30'


select distinct concat("'",NUMEROCOMPROBANTE,"',")
from dbafv.retencion r 
where r.IDCOLABORADOR =138 and FECHACOMPROBANTE >='2023-10-30'

detail.data.DOCUMENTO0='RET0021 021 231113 60282'

 SELECT MVC.NROMOVFISCAL as DEBITO,
 CONCAT('RET', SUBSTRING(LP.USERNAME, 2), SUBSTRING(Z.NOMBREZONA, 2), DATE_FORMAT(RD.FECHACREACION, '%y%m%d'), RD.IDRETENCION) as CREDITO, 
 RD.MONTO as MONTO_DOLAR, 
 RD.MONTO_D as MONTO_LOCAL , 
 CASE WHEN DC.TIPO <>'O/C' THEN DC.TIPO END AS TIPO_DEBITO, 
 'O/C' AS TIPO_CREDITO, 
 CASE WHEN DC.SUBTIPO<>'RETIVA' THEN DC.SUBTIPO END AS SUBTIPO_DEBITO, 
 'RETIVA' AS SUBTIPO_CREDITO
 FROM retenciondetalle RD 
 INNER JOIN movcomercial MVC ON RD.IDMOVCOMERCIALREF = MVC.IDMOVCOMERCIAL 
 INNER JOIN documentocomercial DC ON MVC.IDDOCUMENTO= DC.IDDOCUMENTO 
 INNER JOIN LoginColaborador LP ON LP.USERNAME= RD.USUARIOCREACION 
 INNER JOIN zonas Z ON Z.IDZONAS= RD.IDZONA
 where (RD.IDRETENCION, RD.IDZONA, RD.USUARIOCREACION) IN
( (60282,162,'v0136') )


SELECT C.*
FROM CLIENTE C
    INNER JOIN CLIENTEDIRECCION CD ON C.IDCLIENTE = CD.IDCLIENTE
    INNER JOIN CLIENTEZONA CZ ON C.IDCLIENTE = CZ.IDCLIENTE
    INNER JOIN CYC_CLIENTETELEFONOS CY ON C.IDCLIENTE = CY.IDCLIENTE
    INNER JOIN CYC_LIMITEDECREDITO CYL ON C.IDCLIENTE = CYL.IDCLIENTE
    INNER JOIN CYC_CONCEPTOTRIBUTARIOCLIENTE CYT ON C.IDCLIENTE = CYT.IDCLIENTE
    INNER JOIN CYC_CLIENTEREPRESENTANTE CYR ON C.IDCLIENTE = CYR.IDCLIENTE
    INNER JOIN RUTASDETALLE RD ON C.IDCLIENTE = RD.IDCLIENTE
    INNER JOIN RUTAS R ON RD.IDRUTAS = R.IDRUTAS
    INNER JOIN ZONAS Z ON RD.IDZONAS = Z.IDZONAS
WHERE C.IDCLIENTE = '13540'
GROUP BY C.IDCLIENTE;

select distinct 
 CONCAT('RET', SUBSTRING(LP.USERNAME, 2), SUBSTRING(Z.NOMBREZONA, 2), DATE_FORMAT(RD.FECHACREACION, '%y%m%d'), RD.IDRETENCION) as CREDITO 
 FROM retenciondetalle RD 
 INNER JOIN movcomercial MVC ON RD.IDMOVCOMERCIALREF = MVC.IDMOVCOMERCIAL 
 INNER JOIN documentocomercial DC ON MVC.IDDOCUMENTO= DC.IDDOCUMENTO 
 INNER JOIN LoginColaborador LP ON LP.USERNAME= RD.USUARIOCREACION 
 INNER JOIN zonas Z ON Z.IDZONAS= RD.IDZONA
 where (RD.IDRETENCION, RD.IDZONA, RD.USUARIOCREACION) IN
( (60502,6,'v0035'));

## ----- concatenado de retencion



# -------------- REENVIO --------------
#----------------- RETENCIONES QUE NO SE ENVIARON CORRECTAMENTE --------------------

select 
	R.* 
from retencion r  inner join retenciondetalle r2 on R.IDRETENCION = R2.IDRETENCION 
where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in ((60212, 229,'v0151')) 
	and (r2.IDRETENCION, r2.IDZONA , r2.USUARIOCREACION) in ((60212, 229,'v0151'));


-- Retencion
    -- AFV
select * from retencion r  where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in (
(60092,199,'v0303')
);


select r.IDRETENCION , 	r.IDZONA,l.USERNAME,NUMEROCOMPROBANTE from retencion r inner join logincolaborador l on r.IDCOLABORADOR = l.IDCOLABORADORES  
where  r.NUMEROCOMPROBANTE in 
(
'20231000030934',
'20231000030935',
'20231000030901',
'20231000030902',
'20231000030903',
'20231000030904',
'20231000030905',
'20231000030875',
'20231000030888',
'20231000030889',
'20231000030890',
'20231000030891'
)

select * from retencion r  where (r.IDRETENCION, r.IDZONA, r.USUARIOCREACION) in (
(60502,6,'v0035')
);

INSERT INTO retencion (IDRETENCION,IDCONSECUTIVO,IDMONEDA,IDDOCUMENTO,IDEMISOR,IDRECEPTOR,IDCANALVENTA,IDCOLABORADOR,IDZONA,NUMEROCOMPROBANTE,FECHACOMPROBANTE,FECHAEMISION,FECHAACTUALIZACION,MONTORETENCION,MONTORETENCION_D,ID_CAMBIO,OBSERVACIONES,FECHACREACION,USUARIOCREACION,FECHAUA,USUARIOUA,ESTATUSREGISTRO,ESTATUSRETENCION,FECHATRANSMISION,SDS_SEQUENCE_ID,MONEDATRANSICION) VALUES (60502,0,100,10,12490,1,6,250,6,'20231100000001','2023-11-16','2023-11-16',NULL,2130.4100,74034.5804,NULL,'','2023-11-16 12:54:54','v0035',NULL,NULL,'V','V','2023-11-16 13:56:39',925407,0)
ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);


INSERT INTO retencion (IDRETENCION,IDCONSECUTIVO,IDMONEDA,IDDOCUMENTO,IDEMISOR,IDRECEPTOR,IDCANALVENTA,IDCOLABORADOR,IDZONA,NUMEROCOMPROBANTE,FECHACOMPROBANTE,FECHAEMISION,FECHAACTUALIZACION,MONTORETENCION,MONTORETENCION_D,ID_CAMBIO,OBSERVACIONES,FECHACREACION,USUARIOCREACION,FECHAUA,USUARIOUA,ESTATUSREGISTRO,ESTATUSRETENCION,FECHATRANSMISION,SDS_SEQUENCE_ID,MONEDATRANSICION) VALUES
(60196,0,100,10,15525,1,6,73,83,'20231100005825','2023-11-01','2023-11-14',NULL,15.2400,533.0342,NULL,'','2023-11-13 22:56:56','v0019',NULL,NULL,'V','V','2023-11-13 23:01:30',869218,0) ON DUPLICATE KEY
UPDATE IDRETENCION = values(IDRETENCION);


# -------------- REENVIO --------------
#----------------- RETENCIONES QUE NO SE ENVIARON CORRECTAMENTE --------------------



# ----------- ZONAS CON CODIGO DE ZONA
select * 
from dbafv.zonas z  
where 
Z.NOMBREZONA ='Z019';


   
       
       


select * from dbafv.zonas z  where z.NOMBREZONA  like '%Z211%'

select * from dbafv.cuentabancariainterna c where c.NUMEROCUENTABANCARIA ='01340187071873003703'

select * from dbafv.logincolaborador l where l.USERNAME like '%v0211%'

select * from dbafv.recibo r where IDRECIBO= 60411


select * from dbafv.movcomercial m where NROMOVFISCAL = '06606333'


SELECT * FROM DBAFV.ORDEN_LOTE O WHERE O.NUMORDEN=60318 AND O.IDCLIENTE=1748;

P + vendedor + idzonas + fechatransaccion + numorden
P019119123110660318








SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=139;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=139;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=139;
SELECT * FROM DBAFV.ARTICULOPROMOCION WHERE IDAGRUPACION=139;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=139;


SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=142;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=142;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=142;
SELECT * FROM DBAFV.ARTICULOPROMOCION WHERE IDAGRUPACION=142;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=142;


SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=143;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=143;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=143;
SELECT * FROM DBAFV.ARTICULOPROMOCION WHERE IDAGRUPACION=143;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=143;



SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=1003;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=1003;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=1003;
SELECT * FROM DBAFV.ARTICULOPROMOCION WHERE IDAGRUPACION=1003;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=1003;


SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=1004;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=1004;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=1004;
SELECT * FROM DBAFV.ARTICULOPROMOCION WHERE IDAGRUPACION=1004;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=1004;

SELECT * FROM DBAFV.articulos where idarticulo =7049



SELECT * FROM DBAFV.PROMOCIONCABECERA P WHERE P.IDPROMOCION=1001;
SELECT * FROM DBAFV.PROMOCIONDETALLE P WHERE P.IDPROMOCION=1001 and idarticulo=203;
SELECT * FROM DBAFV.PROMOCIONNIVEL P WHERE P.IDPROMOCION=1001 and idarticulo=203;
SELECT * FROM DBAFV.ARTICULOPROMOCION ap where ap.idarticulo in (3338, 3295,3296);

SELECT * FROM DBAFV.articulos ap where ap.idarticulo in (3338);

select * from retencion r 

SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDPROMO=1001;

select * from DBAFV.TIPOPROMOCION

SELECT IDZONAS, NOMBREZONA  FROM zonas z WHERE IDZONAS=4033;

SELECT * from dbafv.transacciones t where t.NUMEROFISCAL ='06559886';

select * from cliente c where c.IDCLIENTE =2943;

SELECT * from dbafv.rutas r where r.idzonas=91;
SELECT * from dbafv.rutasDETALLE r where r.idzonas=91;
SELECT * from dbafv.CLIENTEZONA r where IDCLIENTE ='2943'; r.idzonas=91;


SELECT * FROM DBAFV.AFVZONASPROMO WHERE IDZONAS=120 AND IDPROMO=1003;
SELECT * FROM DBAFV.AFVZONASPROMO WHERE codigozona like '%96%' AND IDPROMO=1003;


select * from orden_lote ol where OL.NUMORDEN =61324 and IDCLIENTE = 13179


show processlist;

INSERT INTO promocioncabecera (IDPROMOCION, IDPROMOCIONMOTIVO, DESCPROMOCION, FECHAINICIO, FECHAFIN, FECHAEMISION, OBSERVACIONES, USUARIO, IDSTATUS)
VALUES (1352,1,"(FEBRERO)TUBRICA TUBO AGUA FRIA RESTO DEL PAIS (500dlrs-26porciento))","2024-01-31T00:00:00","2024-02-29T00:00:00","2024-02-06T08:30:44.567","1/2\" 3/4\" 1\"","cesargonzalezfebeca",2);

-- ---------------------------------------------------------------------------

SELECT * FROM DBAFV.CLIENTE C WHERE C.CODNEMONICO='1761633';

select IDRECIBO , IDZONA , USUARIOCREACION  from recibo r where r.idrecibo= 60482 and r.IDRECEPTORRECIBO =1910;

select IDANEXO  , IDZONA , USUARIOCREACION from anexo a where a.NUMEROPLANILLA ='1320202799'

select * from anexo a where a.NUMEROPLANILLA ='1320202799';
select * from anexo a where a.NUMEROPLANILLA ='1320202800';

select * from transacciones t where T.NUMEROFISCAL  in (
'06636642'
)

select * from cuentabancariainterna c 
where IDCUENTABANCARIA =39;

select * from transacciones t2 where t2.NUMEROFISCAL in (
'06634202',
'06636760')

select * from movcomercial t where T.NROMOVFISCAL in (
'06634202',
'06636760')

select * from movcomercialimpuesto m  where m.IDMOVCOMERCIAL  in (
465431,
468299,
468300,
606627)

select * from movcomercialarticulo m  where m.IDMOVCOMERCIAL  in (
465431,
468299,
468300,
606627)


select * from transacciones t where T.NUMEROFISCAL  in (
'06638357'
)

select * from movcomercial t where T.NROMOVFISCAL in (
'06638357'
)

select distinct m.NROMOVFISCAL  from movcomercial m
inner join movcomercialimpuesto m2 on
	m.IDMOVCOMERCIAL = m2.IDMOVCOMERCIAL
where
	m.NROMOVFISCAL in 
(
'06634202',
'06636618',
'06636655',
'06636604',
'06636615',
'06636760',
'06636621',
'06636619',
'06636620',
'06636626',
'06636627',
'06636612',
'06636640',
'06636658',
'06636659',
'06636663',
'06636611',
'06636629',
'06636638',
'06636605',
'06636603',
'06636602',
'06636650',
'06636636',
'06636637',
'06636616',
'06636630',
'06636631',
'06636622',
'06636624',
'06636643',
'06636647',
'06636607',
'06636644',
'06636642'
)


select distinct m.NROMOVFISCAL from movcomercial m inner join movcomercialarticulo m3 on m.IDMOVCOMERCIAL =m3.IDMOVCOMERCIAL 
where m.NROMOVFISCAL in 
(
'06634202',
'06636618',
'06636655',
'06636604',
'06636615',
'06636760',
'06636621',
'06636619',
'06636620',
'06636626',
'06636627',
'06636612',
'06636640',
'06636658',
'06636659',
'06636663',
'06636611',
'06636629',
'06636638',
'06636605',
'06636603',
'06636602',
'06636650',
'06636636',
'06636637',
'06636616',
'06636630',
'06636631',
'06636622',
'06636624',
'06636643',
'06636647',
'06636607',
'06636644',
'06636642'
)


select t2.M3_numerofiscal, t.*
from transacciones t 
left join (
select distinct m.NROMOVFISCAL as M3_numerofiscal from movcomercial m inner join movcomercialarticulo m3 on m.IDMOVCOMERCIAL =m3.IDMOVCOMERCIAL 
where m.NROMOVFISCAL in 
(
'06634202'
)
) t2 on t.NUMEROFISCAl=t2.M3_numerofiscal
where t.NUMEROFISCAL  in 
(
'06638357'
)

# Factura en MOVCOERCIAL Y NO EN TRANSACCIONES
select 
	m.NROMOVFISCAL as 'NROMOVFISCAL_movcomercial',
	t.NUMEROFISCAL as 'NUMEROFISCAL_transacciones' 
from 
	(select m.NROMOVFISCAL from dbafv.movcomercial m where m.FECHAUA >= '2024-01-10' ) m 
	left join transacciones t on m.NROMOVFISCAL =t.NUMEROFISCAL 
where 
	t.NUMEROFISCAL IS null;


# Factura en TRANSACCIONES Y NO EN MOVCOERCIAL 
select 
	m.NROMOVFISCAL as 'NROMOVFISCAL_movcomercial',
	t.NUMEROFISCAL as 'NUMEROFISCAL_transacciones' 
from 
	dbafv.movcomercial m 
	right join transacciones t on m.NROMOVFISCAL =t.NUMEROFISCAL 
where 
	t.NUMEROFISCAL IS NULL;


select * from movcomercial m where m.NROMOVFISCAL  in (

)


select m.NROMOVFISCAL , t.NUMEROFISCAL  from transacciones t left join movcomercial m on t.NUMEROFISCAL =m.NROMOVFISCAL 
where t.NUMEROFISCAL in (
02795117,
02842875,
02842902,
02843056,
02843057,
02843095,
02843100,
02843154,
02843177,
02843181,
02843235,
02843253,
02843254,
02843283,
02843423,
02843438,
06638013,
06638194,
06638357,
06638659
)

02795117
06638194
02843095
02843181
02843423



INSERT INTO recibo (IDRECIBO, IDCONSECUTIVO, IDDOCUMENTO, NUMERORECIBO, IDRECEPTORRECIBO, IDEMISORRECIBO, IDCANALVENTA, FECHAEMISION, FECHAVENCIMIENTO, FECHAACTUALIZACION, MONTORECIBO, MONTOSOBREPAGO, MONTORECIBO_D, MONTOSOBREPAGO_D, TASA_CAMBIO, IDMONEDA, IDZONA, IDCOLABORADOR, OBSERVACIONES, USUARIOACTUALIZACION, IMPRESIONRECIBO, FECHAIMPRESION, ESTATUSRECIBO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION, DIFERENCIALCAMBIARIO) 
VALUES 
(60090, 0, 7, '00060090', 4483, 1, 6, '2024-01-30', null, null, 145.6400, -0.6400, 0.0000, -23.0200, null, 100, 230, 71, '', null, 0, null, 'R', '2024-01-30 14:38:46', 'v0167', null, null, 'V', '2024-01-30 14:39:31', 2513719, 0, 0.0000)
ON DUPLICATE KEY UPDATE IDRECIBO = values(IDRECIBO)
;


60090, 230

INSERT INTO dbafv.recibo
(IDRECIBO, IDCONSECUTIVO, IDDOCUMENTO, NUMERORECIBO, IDRECEPTORRECIBO, IDEMISORRECIBO, IDCANALVENTA, FECHAEMISION, FECHAVENCIMIENTO, FECHAACTUALIZACION, MONTORECIBO, MONTOSOBREPAGO, MONTORECIBO_D, MONTOSOBREPAGO_D, TASA_CAMBIO, IDMONEDA, IDZONA, IDCOLABORADOR, OBSERVACIONES, USUARIOACTUALIZACION, IMPRESIONRECIBO, FECHAIMPRESION, ESTATUSRECIBO, FECHACREACION, USUARIOCREACION, FECHAUA, USUARIOUA, ESTATUSREGISTRO, FECHATRANSMISION, SDS_SEQUENCE_ID, MONEDATRANSICION, DIFERENCIALCAMBIARIO)
VALUES(60090, 0, 7, '00060090', 4483, 1, 6, '2024-01-30', NULL, NULL, 145.6400, -0.6400, 0.0000, -23.0200, NULL, 100, 230, 71, '', NULL, 0, NULL, 'R', '2024-01-30 14:38:46', 'v0167', NULL, NULL, 'V', '2024-01-30 14:39:31', 2516954, 0, 0.0000);


select * from dbafv.articulos_lpv al  
where al.IDARTICULO in (
10,
100,
1000,
1004,
101,
1011,
1012,
1015,
1016,
1017,
1018,
1019,
102,
1021,
1023,
1025,
1028,
1029,
103,
1030,
1031,
1033,
1034,
1035,
1038,
1039,
104,
1040,
1041,
1042,
1046,
1047,
1048,
1050,
1053,
1056,
1057,
106,
1064,
1066,
1067,
107,
1074,
1075,
1076,
1077,
1078,
1079,
108,
1080,
1081,
1084,
1086,
109,
1091,
1092,
1093,
1094,
1095,
1097,
1098,
1099,
11,
110,
1102,
1103,
1104,
1108,
1109,
111,
1112,
1113,
1114,
1116,
1117,
1118,
1119,
112,
1120,
1126,
1129,
113,
1130,
1133,
1134,
1135,
114,
1142,
1143,
1145,
1147,
115,
1152,
1153,
1154,
1155,
1156,
1157,
1159,
116,
1161,
1162,
1163,
1164,
1165,
1168,
1169,
1171,
1172,
1173,
1175,
1179,
1180,
1182,
1185,
1186,
1191,
1192,
1193,
1194,
1195,
1198,
1199,
12,
1207,
1209,
1210,
1212,
1215,
1216,
1219,
122,
1222,
1223,
1227,
123,
1230,
1231,
1233,
1234,
1235,
1237,
1238,
1239,
1241,
1247,
125,
1250,
1251,
1252,
1253,
1255,
1258,
1259,
1260,
1261,
1262,
1263,
1265,
1267,
1269,
1270,
1272,
1273,
1275,
1276,
1278,
128,
1281,
1287,
1288,
1289,
1292,
1293,
1294,
1295,
1296,
1297,
1299,
13,
130,
1300,
1301,
1302,
1304,
1305,
1306,
1307,
1308,
1309,
1311,
1314,
1316,
1318,
1319,
132,
1321,
1328,
1329,
133,
1330,
1333,
1334,
1339,
134,
1340,
1341,
1342,
1352,
1353,
1355,
1357,
1358,
136,
1360,
1368,
137,
1371,
1372,
1375,
1376,
1377,
1378,
1379,
1381,
1383,
1386,
1388,
1393,
1394,
1395,
14,
140,
1406,
1409,
141,
1410,
1411,
1413,
1415,
1416,
1417,
1418,
1419,
142,
1420,
1421,
1422,
1425,
1428,
143,
1430,
1432,
1435,
1444,
1446,
1447,
1448,
1449,
145,
1450,
1451,
1452,
1453,
1455,
1456,
1458,
1459,
1460,
1461,
1464,
1465,
1466,
1467,
1468,
1469,
147,
1470,
1471,
1474,
1475,
148,
149,
1492,
1493,
1494,
1495,
15,
150,
1501,
1502,
1505,
1506,
1507,
1508,
1509,
1510,
1511,
1512,
1513,
1514,
1515,
1516,
1518,
1524,
1525,
1526,
1527,
1528,
153,
1531,
1533,
1534,
154,
1542,
1544,
1545,
1547,
1549,
155,
1550,
1556,
1557,
1559,
156,
1560,
1566,
1567,
1568,
1569,
157,
1570,
1574,
1575,
1576,
158,
1580,
1581,
1583,
1584,
159,
1593,
1594,
160,
1608,
161,
1612,
1613,
1615,
1616,
1618,
162,
1624,
1625,
1626,
1627,
1628,
1629,
1630,
1632,
1634,
1636,
1637,
1638,
1639,
164,
1640,
1641,
1643,
1644,
1645,
1646,
1647,
1648,
1654,
1655,
1656,
1657,
1658,
1659,
1660,
1663,
1667,
1668,
167,
1670,
1672,
1674,
1679,
168,
1680,
1681,
1682,
1683,
1684,
1686,
1687,
1688,
1690,
1691,
17,
1701,
1702,
1703,
1704,
1705,
1706,
1707,
1708,
1709,
171,
1714,
1715,
1716,
1717,
1718,
1719,
172,
1728,
1729,
173,
1730,
1731,
1732,
1734,
1736,
1738,
1739,
174,
1740,
1741,
1742,
1745,
1746,
1747,
1748,
1749,
175,
1750,
1751,
1752,
1754,
1755,
1756,
1757,
1758,
176,
1760,
1761,
1762,
1763,
1765,
1766,
1767,
1768,
1769,
177,
1770,
1771,
1772,
1773,
1774,
1776,
1777,
1778,
1779,
178,
1780,
1781,
1782,
1783,
1784,
1785,
1786,
1787,
1788,
1789,
179,
1790,
1793,
1795,
1799,
18,
180,
1801,
1802,
1803,
1804,
1805,
1806,
1807,
1808,
1809,
181,
1810,
1811,
1813,
1814,
1817,
1818
) and ID_LISTAPRECIO =8;


select * from dbafv.articulos_lpv al  
where al.IDARTICULO in (
1819,
182,
1820,
1821,
1822,
1823,
1824,
1825,
1826,
1827,
1828,
1829,
1830,
1832,
1842,
1843,
1844,
1846,
1849,
1850,
1851,
1852,
1854,
1855,
1856,
1858,
1859,
1860,
1861,
1864,
1872,
1873,
1874,
1875,
1876,
1877,
1879,
188,
1880,
1882,
1883,
1884,
1885,
1886,
1887,
1888,
1889,
189,
1892,
1894,
1898,
190,
1906,
1907,
1908,
1909,
191,
1910,
1911,
1912,
1913,
1914,
1915,
1916,
1918,
1919,
192,
1921,
1922,
1923,
1925,
1928,
1929,
193,
1931,
1932,
1938,
194,
1941,
1942,
1943,
1946,
1947,
1948,
1949,
195,
1950,
1951,
1952,
1953,
1955,
1956,
1957,
1958,
1959,
196,
1960,
1962,
1963,
1965,
197,
1974,
1976,
1977,
1978,
1979,
198,
1981,
1982,
1984,
1985,
1986,
1987,
1988,
1989,
199,
1990,
1991,
1992,
1993,
1994,
1996,
1997,
1999,
2,
20,
200,
2000,
2007,
2008,
2009,
201,
2011,
2012,
2013,
2014,
2016,
2018,
2019,
202,
2020,
2021,
2022,
2023,
2024,
2025,
2026,
2027,
2028,
2029,
203,
2030,
2031,
2032,
2033,
2034,
204,
2041,
2044,
2045,
2046,
2047,
2049,
205,
2050,
2051,
2053,
2054,
2055,
2056,
2057,
2058,
2059,
206,
2060,
2061,
2062,
2063,
2064,
2065,
2067,
2068,
207,
2074,
2075,
2076,
2077,
2078,
2079,
2082,
2083,
2084,
2087,
2089,
2090,
2091,
21,
210,
2106,
2107,
2109,
211,
2110,
2111,
2113,
2114,
2116,
2117,
2118,
2119,
2121,
2132,
2134,
2136,
2138,
2139,
2141,
2144,
2146,
215,
2160,
2162,
2167,
2169,
2170,
2171,
2172,
2175,
2176,
218,
2183,
2185,
2186,
2187,
219,
2193,
2194,
2195,
2196,
2199,
22,
2209,
221,
2210,
2211,
2217,
2218,
222,
223,
2235,
2237,
2238,
2239,
224,
2241,
2242,
2244,
2245,
2248,
225,
2259,
226,
2261,
2262,
2265,
2267,
2268,
227,
2270,
2273,
2274,
2275,
2286,
229,
2291,
2293,
2294,
2296,
2297,
2298,
23,
230,
2300,
2301,
2302,
2303,
231,
2310,
2311,
2312,
2314,
2321,
2322,
2323,
2324,
2325,
2326,
2327,
233,
2330,
2332,
2333,
2334,
2335,
2336,
2337,
2338,
2339,
2341,
2342,
2344,
2345,
2346,
2347,
2348,
2349,
2350,
2351,
2352,
2353,
2354,
2355,
2356,
2357,
2358,
2359,
2360,
2361,
2362,
2364,
2366,
2367,
2368,
2369,
237,
2370,
2371,
2372,
2373,
2374,
2375,
2376,
2377,
2378,
2379,
238,
2380,
2381,
2382,
2383,
2385,
2386,
2387,
2388,
2389,
239,
2391,
2392,
2393,
240,
2400,
2401,
2404,
2405,
2406,
2408,
2409,
241,
2410,
2411,
2412,
2413,
2414,
2415,
2416,
2417,
2418,
242,
2420,
2422,
2423,
2424,
2426,
2431,
2432,
2434,
2435,
2436,
2438,
244,
2441,
2442,
2443,
2444,
2445,
2446,
2447,
2448,
2449,
245,
2452,
2454,
2455,
2458,
246,
2460,
2461,
2462,
2463,
2466,
2467,
2468,
2469,
247,
2470,
2471,
2472,
2473,
2474,
2475,
2476,
248,
2480,
2481,
2482,
2483,
2484,
2485,
2487,
2488,
2489,
249,
2495,
2496,
2497,
2498,
2499,
25,
250,
2500,
2501,
2502,
2503,
2504,
2505,
2506,
2507,
251,
2512,
2513,
2518,
2519,
252,
2521,
2522,
2524,
2525,
2526,
2527,
2528,
2529,
253,
2530,
2531,
2532,
2533,
2534,
2535,
2539,
2540,
2541,
2542,
2543,
2546,
2547,
2548,
2555,
2556,
2557,
2558,
2559,
2560,
2563,
2564,
2565,
2567,
2572,
2577,
2578,
2579,
2580,
2581,
2584,
2585,
2586,
2587,
2588,
2589,
259,
2590
) AND al.ID_LISTAPRECIO =8;


select * from dbafv.articulos_lpv al  
where al.IDARTICULO in (
2591,
2592,
2594,
2596,
2597,
2599,
26,
260,
2600,
2601,
2602,
2603,
2604,
2606,
2608,
2609,
2610,
2612,
2613,
2614,
2615,
2616,
2617,
2618,
2619,
262,
2620,
2621,
2623,
2624,
2625,
2626,
2627,
2628,
2629,
2630,
2636,
2637,
2638,
2639,
2641,
2642,
2643,
2644,
265,
2650,
2651,
2652,
2653,
2654,
2655,
2656,
2657,
2658,
2659,
266,
2660,
2661,
2662,
2663,
2665,
2666,
2667,
2668,
2669,
2670,
2676,
2677,
2679,
2680,
2681,
2682,
2683,
2686,
2688,
2689,
2690,
2695,
2698,
2699,
27,
270,
2700,
2701,
2702,
2705,
2707,
2709,
2712,
2713,
2714,
2715,
2717,
2721,
2722,
2723,
2724,
2725,
2726,
2727,
2729,
2733,
2734,
2735,
2736,
2737,
2738,
2741,
2744,
2745,
2746,
2747,
2748,
2749,
2750,
2751,
2752,
2754,
2756,
2757,
2758,
2759,
2761,
2763,
2767,
2770,
2771,
2772,
2773,
2777,
2778,
2779,
278,
2780,
2781,
2782,
2784,
2786,
2788,
2789,
279,
2791,
2792,
2793,
2794,
2795,
2796,
2797,
2799,
28,
280,
2800,
2801,
2802,
2803,
2805,
2806,
281,
2813,
2815,
2817,
2819,
282,
2822,
2823,
2824,
2827,
2828,
2829,
2831,
2833,
2834,
2836,
2838,
2839,
2842,
2843,
2844,
2845,
2847,
2848,
2849,
2854,
2855,
2856,
2857,
2859,
2860,
2861,
2862,
2863,
2865,
2868,
2869,
2870,
2873,
2874,
2875,
2876,
2877,
2878,
2879,
2880,
2881,
2882,
2883,
2884,
2885,
2887,
2889,
289,
2890,
2892,
2894,
2896,
2897,
2898,
2899,
290,
2908,
2909,
291,
2910,
2914,
2915,
2916,
2917,
2918,
2919,
292,
2921,
2924,
2929,
293,
2931,
2932,
2933,
2935,
2936,
2938,
294,
2940,
2941,
2942,
2943,
2944,
295,
2950,
2951,
2952,
2953,
2956,
2958,
2959,
2960,
2961,
2962,
2963,
2964,
2965,
2967,
2968,
297,
2971,
2972,
2973,
2974,
2975,
2976,
2978,
2979,
2980,
2982,
2983,
2984,
2987,
2988,
299,
2991,
2995,
2997,
2998,
2999,
3,
30,
3000,
3006,
3009,
3010,
302,
3021,
3022,
3023,
3024,
3025,
3026,
3027,
3028,
3029,
303,
3030,
3031,
3032,
3033,
3034,
3035,
3036,
3039,
304,
3041,
3042,
3043,
3044,
3045,
3046,
3051,
3052,
3053,
3054,
3055,
3056,
3061,
3062,
3063,
3065,
3067,
3068,
3069,
3070,
3071,
3072,
3073,
3074,
3075,
3076,
3077,
3079,
3082,
3084,
3085,
3086,
3087,
3088,
3089,
309,
3091,
3092,
3093,
3094,
3095,
3096,
3097,
3098,
3099,
31,
310,
3100,
3106,
3108,
311,
3110,
3111,
3113,
3114,
3115,
3117,
3119,
3120,
3126,
3129,
313,
3130,
3131,
3132,
3137,
3138,
3139,
3140,
3141,
3147,
3148,
3149,
315,
3151,
3153,
3154,
3155,
3156,
3157,
3158,
3159,
3161,
3165,
3166,
3167,
3168,
3169,
317,
3170,
3171,
3173,
3175,
3177,
3178,
3179,
3180,
3181,
3187,
3188,
3191,
3193,
3195,
3197,
3198,
3199,
32,
3200,
3202,
3209,
3210,
3211,
3215,
3217,
3219,
322,
3220,
3222,
3223,
3224,
323,
3231,
3232,
3233,
3235,
3236,
3237,
3238,
3239,
324,
3240,
3242,
3245,
3250,
3253,
3256,
3257,
3258,
3259,
326,
3260,
3262,
3264,
3265,
3267,
3269,
3275,
3276,
3277,
3279,
3280,
3282,
3283,
3284,
3286,
3291,
3292,
3293,
3294,
3296,
3297,
3298,
3299,
33,
3301,
3302,
3303,
3304,
3305,
3306,
3308,
3310,
3311,
3312,
3316,
3318,
3319,
3320,
3321,
3322,
3323,
3325,
3326,
3327,
3328,
3329,
333,
3330,
3331,
3332,
3333,
3334,
3335,
3336,
3337,
3338,
334,
3340,
3342,
3343,
3344,
3345,
335,
3351,
3352,
3353,
3354,
3355,
3358,
336,
3362,
3363,
3364,
3365,
3366,
3367,
3372,
3373,
3374,
3375,
3376,
3377,
338,
3384,
3385,
3386,
3387,
3388,
339,
3390,
3392,
3394,
3395,
3396,
3397,
3398,
3399,
3400,
3402,
3403,
3404,
3406,
3407,
3408,
3409,
3410,
3414,
3417,
3418,
3419,
3425,
3427,
3431,
3432,
3439,
3440,
3442,
3443,
3444,
3447,
3451,
3454,
3457,
346,
3461,
3462,
3463,
3465,
3466,
3467,
3468,
3469,
347,
3470,
3472,
3473,
3474,
348,
3483,
3484,
3485,
3486,
3487,
3488,
3489,
3490,
3491,
3493,
3494,
3496,
3498,
3499,
350,
3501,
3502,
3503,
3504,
3505,
3506,
3507,
3508,
3509,
351,
3510,
3512,
3513,
3515,
3519,
352,
3520,
3523,
3525,
3526,
3527,
3529,
353,
3531,
3538,
3539,
3541,
3543,
3545,
3547,
3551,
3552,
3559,
3560,
3561,
3562,
3563,
3565,
3568,
3569,
3571,
3575,
3579,
3583,
3584,
3585,
3586,
3587,
3588,
3589,
3591,
3596,
3597,
36,
3602,
3603,
3604,
3605,
3607,
3608,
361,
3612,
3618,
3619,
362,
3620,
3623,
3624,
3625,
3626,
3627,
3628,
3629,
3634,
3635,
3637,
3638,
3642,
3643,
3644,
3648,
3649,
365,
3650,
3653,
3656,
3658,
3659,
3661,
3662,
3669,
367,
3670,
3671,
3672,
3674,
3675,
3676,
3677,
3678,
3692,
3694,
3695,
3697,
3698,
3699,
37,
370,
3704,
3705,
3707,
3708,
3709,
371,
3710,
3711,
3712,
3724,
3725,
3726,
3727,
3728,
3729,
373,
3730,
3731,
3732,
3733,
3734,
3736,
3737,
3738,
3739,
3740,
3747,
3748,
375,
3752,
3753,
3755,
3756,
3757,
3758,
3759,
376,
3760,
3761,
3762,
3763,
3764,
3765,
3767,
3768,
3769,
377,
3770,
3777,
3782,
3788,
3789,
3790,
3791,
3792,
3793,
3794,
3796,
3797,
3798,
3799,
3804,
3805,
3813,
3815,
3816,
3818,
3819,
3820,
3822,
3824,
3825,
3826,
3827,
3828,
3829,
3830,
3833,
3835,
384,
3842,
3843,
3844,
3846,
3847,
3854,
3856,
3860,
3861,
3863,
3864,
3868,
3871,
3872,
3875,
3876,
3877,
3878,
3888,
3889,
389,
3890,
3891,
3893,
3894,
390,
3900,
3901,
3907,
3909,
391,
3910,
392,
3921,
3923,
3924,
393,
3935,
3936,
3937,
394,
3949,
395,
3952,
3953,
3954,
3955,
3957,
3965,
3966,
3967,
3968,
397,
3972,
3973,
3975,
3976,
3979,
398,
3983,
3984,
3985,
3986,
3987,
3988,
3989,
3992,
3994,
3995,
3996,
3997,
3999,
4,
40,
4000,
4002,
4003,
4004,
4005,
4009,
4011,
4012,
4013,
4015,
4017,
4018,
4020,
4021,
4022,
4024,
4026,
4027,
4029,
4030,
4031,
4032,
4035,
4036,
4037,
4039,
4041,
4042,
4043,
4044,
4045,
4047,
4050,
4051,
4054,
4055,
4056,
4058,
4061,
4063,
4065,
4069,
4070,
4071,
4072,
4076,
4077,
4079,
4080,
4081,
4082,
4085,
4086,
4087,
4089,
4090,
4091,
4093,
4094,
4095,
4099,
41,
410,
4100,
4101,
4102,
4103,
411,
4111,
4112,
4113,
4115,
4116,
4117,
4118,
4120,
4122,
4128,
4129,
4130,
4132,
4133,
4134,
4135,
414,
4143,
4144,
4147,
415,
4156,
4170,
4172,
4182,
419,
4190,
4191,
4197,
4199,
42,
421,
4211,
4213,
4217,
4219,
422,
423,
4238,
4240,
4242,
4245,
4246,
4249,
4257,
4260,
4261,
4262,
4265,
4266,
4278,
4279,
4280,
4282,
4283,
4284,
4285,
4286,
4287,
43,
430,
4306,
4307,
4308,
4309,
431,
4311,
4312
) AND al.ID_LISTAPRECIO =8;

select * from dbafv.articulos_lpv al  
where al.IDARTICULO in (
4313,
4314,
4315,
4316,
4317,
432,
433,
4330,
4331,
4332,
4333,
4335,
4337,
4338,
4339,
434,
435,
4353,
4355,
4357,
4358,
4359,
436,
4361,
4363,
4375,
4376,
4377,
4378,
438,
4380,
4381,
4382,
4384,
4385,
4386,
4390,
4398,
4399,
44,
440,
4400,
4402,
4403,
4405,
4406,
4407,
4408,
441,
442,
4422,
4425,
4427,
4429,
443,
4430,
4432,
444,
4444,
4445,
4446,
4448,
445,
4450,
4451,
4452,
4457,
446,
4464,
4465,
4469,
447,
4470,
4471,
4472,
4473,
4474,
4476,
4480,
4481,
4482,
4485,
4491,
4499,
45,
4500,
4501,
4504,
4505,
4506,
4507,
4508,
4511,
4513,
4514,
4515,
4529,
4530,
4531,
4532,
4533,
4534,
4536,
4538,
4539,
4540,
4541,
4543,
4544,
4545,
4547,
455,
4559,
4561,
4563,
4564,
4565,
4566,
4568,
4569,
4570,
4571,
4572,
4576,
4580,
4581,
4582,
4590,
4591,
4592,
4593,
4594,
4595,
4598,
4599,
46,
4600,
4601,
4602,
4603,
4606,
461,
462,
4620,
4621,
4622,
4623,
4624,
4625,
4626,
4627,
4629,
463,
4630,
4631,
4633,
4634,
4635,
4636,
4637,
4638,
464,
4640,
465,
4652,
4654,
4655,
4656,
4658,
4659,
466,
4661,
4663,
4664,
4665,
4666,
4667,
4668,
467,
4671,
4672,
4673,
4674,
468,
4683,
4684,
4685,
4686,
4687,
4688,
4689,
469,
4690,
4692,
4693,
4694,
4695,
4697,
4698,
4699,
47,
470,
4705,
471,
4713,
4714,
4715,
4716,
4717,
4718,
4719,
472,
4720,
4721,
4722,
4723,
4724,
4725,
4727,
4728,
4729,
4731,
4732,
4733,
474,
4742,
4744,
4745,
4746,
4747,
4754,
4755,
4756,
4757,
4758,
4759,
4760,
4761,
4762,
4763,
4764,
4768,
4769,
4774,
4775,
4780,
4783,
4784,
4785,
4787,
4788,
4795,
4797,
4799,
48,
4800,
4801,
4802,
4803,
4804,
4805,
4806,
4809,
4810,
4811,
4812,
4814,
482,
4822,
4823,
4824,
4825,
4826,
4827,
4835,
4836,
4837,
4839,
4842,
4843,
4844,
4845,
4846,
4847,
4848,
4849,
485,
4850,
4858,
4862,
4863,
4864,
4866,
4867,
487,
4874,
4875,
4879,
488,
4880,
4881,
4882,
4884,
4885,
4886,
4887,
4888,
4889,
489,
4890,
4891,
4894,
4895,
4896,
49,
490,
4901,
4903,
4904,
4905,
4906,
4907,
4908,
491,
4912,
4914,
4915,
4916,
4917,
4918,
4919,
492,
4920,
4921,
4923,
4924,
4925,
4926,
4927,
4928,
4929,
493,
4930,
4931,
4936,
494,
4940,
4942,
4945,
4946,
4947,
4948,
495,
4954,
4955,
4956,
4957,
4958,
4959,
4960,
4961,
4963,
4964,
4965,
4966,
4967,
4968,
4969,
4970,
4971,
4972,
4976,
4977,
4983,
4984,
4986,
4987,
4994,
4995,
4996,
4997,
4998,
4999,
5,
50,
500,
5000,
5001,
5002,
5003,
5004,
5005,
5006,
5007,
5008,
5010,
5011,
5013,
5015,
5022,
5023,
5024,
5025,
5027,
5028,
5033,
5034,
5038,
5040,
5041,
5042,
5044,
5051,
5054,
5059,
506,
5060,
5061,
5063,
5066,
5067,
507,
5074,
5075,
5077,
5078,
508,
5080,
5083,
5087,
5088,
509,
5099,
510,
5100,
5101,
5102,
5103,
5104,
5105,
5106,
5107,
5108,
511,
5112,
512,
5121,
5122,
5123,
5124,
5126,
5129,
513,
5130,
5131,
514,
5145,
5147,
5148,
5149,
515,
5150,
516,
5169,
5170,
5171,
5172,
5173,
5174,
5175,
5176,
5178,
5179,
518,
5190,
5192,
5193,
5194,
5195,
5196,
5198,
5199,
52,
5200,
5201,
5215,
5216,
5217,
5218,
5219,
5220,
5221,
5222,
5223,
5224,
5237,
5243,
5244,
5245,
5246,
5247,
5249,
5250,
5251,
5252,
5253,
5255,
5257,
5258,
5259,
5261,
5262,
5263,
5265,
5269,
5272,
5273,
5275,
5276,
528,
5286,
5287,
5288,
5289,
5297,
5298,
53,
5300,
5301,
5302,
5303,
5304,
5305,
5306,
5307,
5309,
5310,
5311,
5312,
5314,
5318,
5319,
532,
5320,
5321,
5322,
5324,
5325,
5327,
5328,
533,
5330,
5335,
5336,
5337,
5338,
5339,
5345,
5347,
5348,
5349,
5350,
5351,
5352,
5353,
5354,
5355,
5356,
5357,
5358,
5359,
536,
5364,
5368,
5369,
537,
5374,
5377,
5378,
538,
5380,
5384,
5387,
5389,
539,
5392,
5397,
540,
5400,
5401,
5403,
5404,
5405,
5407,
541,
5410,
5411,
5412,
5413,
5414,
5415,
5416,
5417,
542,
5422,
5427,
543,
5430,
5431,
5432,
5434,
5435,
5436,
5437,
544,
545,
5451,
5452,
5453,
5454,
5455,
5456,
5457,
5458,
5459,
546,
5460,
5461,
5462,
5463,
5464,
5469,
547,
5474,
5476,
5477,
5479,
548,
5480,
5481,
5482,
5484,
5485,
5486,
5487,
5488,
5489,
549,
5490,
5491,
5492,
5494,
550,
5500,
5501,
5503,
5504,
5505,
5507,
5508,
551,
5510,
5512,
5529,
553,
5530,
5532,
5533,
5534,
5535,
5536,
5537,
5538,
5539,
554,
5540,
5541,
5542,
5543,
5544,
5545,
555,
5553,
5554,
5556,
556,
5560,
5562,
5564,
5567,
5568,
557,
5577,
558,
5580,
5582,
5583,
5584,
5586,
5588,
5589,
5590,
5591,
5592,
5593,
56,
560,
5602,
5605,
5606,
5608,
561,
5610,
5612,
5613,
5616,
5619,
562,
5626,
563,
5633,
5634,
5635,
5643,
5651,
5652,
5653,
5654,
5657,
5662,
5663,
5668,
5669,
5670,
5671,
5672,
5673,
5674,
5675,
5676,
5677,
5679,
5680,
5681,
5682,
5685,
5688,
5689,
5690,
5691,
5692,
5693,
5694,
5695,
5696,
5697,
5698,
5699,
5700,
5701,
5703,
5704,
5705,
5706,
5708,
5709,
571,
5710,
5711,
5714,
5715,
5716,
5717,
5718,
5719,
572,
5720,
5723,
5730,
5732,
5733,
5734,
5735,
5736,
5737,
5738,
5739,
574,
5740,
5741,
5742,
5744,
5745,
5746,
5747,
5748,
5749,
5750,
5751,
5752,
5753,
5754,
5756,
5757,
576,
5764,
5765,
5766,
5767,
5769,
577,
5770,
5771,
5773,
5774,
5776,
5778,
5783,
5784,
5785,
5786,
5789,
5791,
5797,
5798,
5799,
58,
5800,
5801,
5802,
5804,
5805,
5806,
5807,
5808,
5809,
5812,
5814,
5815,
5817,
5819,
582,
5820,
5821,
5823,
5824,
5825,
5826,
5829,
583,
5830,
5831,
5832,
5833,
5834,
5835,
5836,
5837,
5838,
584,
5840,
5841,
5842,
5843,
5844,
5845,
5846,
5847,
5848,
585,
5850,
5851,
5855,
5856,
5857,
5858,
5859,
586,
5861,
5862,
5863,
5864,
5865,
5866,
5867,
5868,
5869,
5871,
5872,
5873,
5875,
5876,
5877,
5878,
5880,
5881,
5882,
5883,
5884,
5885,
5886,
5887,
5889,
589,
5890,
5896,
5899,
59,
5900,
5901,
5902,
5903,
5904,
5905,
5906,
5907,
5914,
5915,
5916,
5917,
5918,
5919,
5920,
5921,
5922,
5923,
5924,
5925,
5926,
5927,
5928,
5929,
5931,
5932,
5933,
5934,
5935,
5936,
5939,
594,
5940,
5943,
5944,
5945,
5946,
5947,
5948,
5949,
5950,
5951,
5952,
5953,
5954,
596,
5961,
5962,
5963,
5964,
5965,
5966,
5969,
5973,
5974,
5975,
5976,
5977,
5978,
5979,
5980,
5981,
5982,
5983,
5986,
5989,
5997,
5998,
5999,
6,
6000,
6001,
6002,
6003,
6004,
6005,
6006,
6007,
6008,
6009,
6013,
6014,
6015,
6017,
602,
6020,
6022,
6023,
6027,
6028,
6029,
6030,
6032,
6036,
6037,
6040,
6042,
6044,
6045,
6049,
6050,
6052,
6053,
6057,
6058,
6060,
6061,
6062,
6063,
6064,
6066,
6067,
6068,
6069,
6075,
6077,
6079,
6080,
6082,
6083,
6084,
6085,
6087,
6088,
6089,
6090,
6091,
6092,
6098,
6099,
6100,
6101,
6102,
6103,
6107,
6108,
611,
6110,
6111,
6112,
6115,
6116,
6117,
6118,
6119,
612,
6120,
6121,
6122,
6123,
6124,
6125,
6129,
613,
6130,
6131,
6132,
6133,
6134,
6135,
6136,
6137,
6138,
614,
6140,
6141,
6142,
6143,
6144,
6146,
6148,
6149,
615,
6150,
6151,
6152,
6153,
6154,
6157,
6158,
6159,
616,
6160,
6161,
6162,
6163,
6168,
617,
6170,
6171,
6172,
6173,
6174,
6175,
6176,
6178,
6181,
6182,
6184,
6185,
6186,
6187,
6188,
6189,
619,
6194,
6195,
6196,
6197,
6198,
620,
6201,
6203,
6206,
6207,
6208,
621,
6210,
6211,
6213,
6214,
6217,
6218,
622,
6220,
6221,
6222,
6223,
6224,
6225,
6226,
6230,
6233,
6237,
6238,
6239,
6240,
6241,
6242,
6243,
6244,
6245,
6246,
6247,
6248,
6249,
6250,
6252,
6254,
6259,
626,
6260,
6261,
6263,
6264,
6265,
6266,
6267,
6268,
6269,
627,
6271,
6273,
6274,
6275,
6276,
6277,
6279,
6283,
6286,
6287,
6288,
6290,
6291,
6292,
6293,
6294,
6295,
6296,
6298,
6299,
630,
6300,
6301,
6303,
6304,
6305,
6306,
6312,
6313,
6314,
6316,
6317,
6318,
6319,
632,
6320,
6324,
6325,
6328,
633,
6330,
6331,
6332,
6333,
6336,
6337,
6338,
6339,
634,
6340,
6347,
6348,
6350,
6351,
6354,
6355,
6356,
6357,
6358,
6362,
6363,
6364,
6365,
6372,
6373,
6375,
6379,
6380,
6383,
6384,
6385,
6386,
6387,
6388,
6389,
6394,
6396,
6397,
6398,
6399,
64,
6400,
6401,
6403,
6405,
6406,
6407,
6410,
6415,
6416,
6417,
6418,
6420,
6424,
6425,
6426,
6427,
6428,
6429,
643,
6430,
6431,
6432,
6433,
6434,
6435,
6436,
6438,
644,
6441,
6442,
6443,
6448,
6450,
6452,
6454,
6455,
6456,
6464,
6466,
6467,
6471,
6472,
6473,
6474,
6475,
6476,
6478,
6480,
6481,
6482,
6483,
6484,
6485,
6489,
6491,
6493,
6494,
6497,
6499,
6500,
6502,
6510,
6512,
6515,
6517,
6518,
6523,
653,
6530,
654,
655,
6557,
656,
657,
6570,
6577,
658,
659,
66,
660,
6604,
661,
6611,
6612,
6613,
6614,
6615,
6617,
662,
6624,
663,
664,
6645,
6653,
667,
67,
671,
6729,
6732,
6733,
6736,
674,
6747,
6748,
675,
6753,
678,
6782,
6785,
6786,
6788,
679,
6790,
6795,
68,
680,
6804,
6805,
6808,
6816,
6821,
6822,
6824,
6825,
683,
6833,
6834,
6836,
6838,
6839,
684,
6841,
6860,
6864,
6865,
6866,
6867,
687,
688,
6883,
6885,
6886,
6887,
6888,
6898,
6900,
6905,
6908,
6912,
6918,
692,
6924,
6925,
6926,
6928,
6929,
693,
6931,
6933,
694,
6944,
695,
6958,
696,
6968,
6969,
6973,
6975,
6976,
698,
699,
6993,
6994,
6995,
6996,
7,
700,
7001,
7004,
701,
7019,
702,
7022,
703,
7046,
7047,
7048,
7049,
705,
7051,
706,
7060,
707,
708,
709,
7094,
71,
711,
712,
716,
718,
72,
720,
721,
723,
725,
727,
730,
733,
734,
735,
736,
737,
738,
739,
7390,
74,
740,
741,
742,
743,
7489,
75,
750,
753,
754,
7546,
755,
7554,
7555,
7556,
758,
7590,
7591,
76,
760,
761,
7614,
7625,
7627,
7628,
7633,
765,
767,
7674,
7736,
774,
7742,
775,
776,
777,
779,
78,
780,
7800,
781,
782,
783,
784,
787,
788,
79,
7902,
791,
792,
793,
794,
795,
796,
797,
798,
8,
80,
800,
801,
804,
81,
811,
812,
813,
815,
816,
817,
819,
82,
821,
822,
826,
829,
83,
830,
831,
832,
834,
835,
838,
839,
84,
840,
843,
844,
845,
849,
85,
850,
852,
853,
854,
858,
859,
86,
862,
864,
865,
867,
868,
869,
871,
872,
873,
874,
877,
878,
879,
882,
883,
884,
885,
886,
888,
89,
890,
892,
895,
896,
897,
898,
9,
90,
900,
901,
902,
904,
905,
91,
910,
913,
916,
917,
918,
919,
92,
920,
921,
922,
923,
924,
926,
928,
929,
93,
930,
938,
939,
94,
943,
944,
946,
95,
950,
951,
952,
953,
956,
957,
958,
959,
96,
960,
963,
964,
965,
966,
967,
969,
97,
970,
974,
975,
977,
978,
98,
980,
981,
982,
99,
992,
993,
994,
995,
996,
997
) AND al.ID_LISTAPRECIO =8;


select IDARTICULO , PRECIOLISTA ,FECHAOPERACION from dbafv.articulos_lpv al  
where al.IDARTICULO in (
1,
58,
90,
371,
392,
490,
562,
667,
819,
850,
1113,
1230,
1648,
1832,
1909,
2011,
2187,
2241,
2370,
2420,
2590,
3496,
3583,
3607,
4332,
4505,
4673,
5023,
5273,
5347,
5404,
5606,
5723,
5744,
5841,
5851,
5865,
6099,
6122,
6133,
6286,
6362,
6476,
6512,
6729,
6732,
7048
) and al.ID_LISTAPRECIO =8;

10,
100,
1000,
1004,
101,
1011,
1012,
1015,
1016,
1017,
1018,
1019,
102,
1021,
1023,
1025,
1028,
1029,
103,
1030,
1031,
1033,
1034,
1035,
1038,
1039,
104,
1040,
1041,
1042,
1046,
1047,
1048,
1050,
1053,
1056,
1057,
106,
1064,
1066,
1067,
107,
1074,
1075,
1076,
1077,
1078,
1079,
108,
1080,
1081,
1084,
1086,
109,
1091,
1092,
1093,
1094,
1095,
1097,
1098,
1099,
11,
110,
1102,
1103,
1104,
1108,
1109,
111,
1112,
1113,
1114,
1116,
1117,
1118,
1119,
112,
1120,
1126,
1129,
113,
1130,
1133,
1134,
1135,
114,
1142,
1143,
1145,
1147,
115,
1152,
1153,
1154,
1155,
1156,
1157,
1159,
116,
1161,
1162,
1163,
1164,
1165,
1168,
1169,
1171,
1172,
1173,
1175,
1179,
1180,
1182,
1185,
1186,
1191,
1192,
1193,
1194,
1195,
1198,
1199,
12,
1207,
1209,
1210,
1212,
1215,
1216,
1219,
122,
1222,
1223,
1227,
123,
1230,
1231,
1233,
1234,
1235,
1237,
1238,
1239,
1241,
1247,
125,
1250,
1251,
1252,
1253,
1255,
1258,
1259,
1260,
1261,
1262,
1263,
1265,
1267,
1269,
1270,
1272,
1273,
1275,
1276,
1278,
128,
1281,
1287,
1288,
1289,
1292,
1293,
1294,
1295,
1296,
1297,
1299,
13,
130,
1300,
1301,
1302,
1304,
1305,
1306,
1307,
1308,
1309,
1311,
1314,
1316,
1318,
1319,
132,
1321,
1328,
1329,
133,
1330,
1333,
1334,
1339,
134,
1340,
1341,
1342,
1352,
1353,
1355,
1357,
1358,
136,
1360,
1368,
137,
1371,
1372,
1375,
1376,
1377,
1378,
1379,
1381,
1383,
1386,
1388,
1393,
1394,
1395,
14,
140,
1406,
1409,
141,
1410,
1411,
1413,
1415,
1416,
1417,
1418,
1419,
142,
1420,
1421,
1422,
1425,
1428,
143,
1430,
1432,
1435,
1444,
1446,
1447,
1448,
1449,
145,
1450,
1451,
1452,
1453,
1455,
1456,
1458,
1459,
1460,
1461,
1464,
1465,
1466,
1467,
1468,
1469,
147,
1470,
1471,
1474,
1475,
148,
149,
1492,
1493,
1494,
1495,
15,
150,
1501,
1502,
1505,
1506,
1507,
1508,
1509,
1510,
1511,
1512,
1513,
1514,
1515,
1516,
1518,
1524,
1525,
1526,
1527,
1528,
153,
1531,
1533,
1534,
154,
1542,
1544,
1545,
1547,
1549,
155,
1550,
1556,
1557,
1559,
156,
1560,
1566,
1567,
1568,
1569,
157,
1570,
1574,
1575,
1576,
158,
1580,
1581,
1583,
1584,
159,
1593,
1594,
160,
1608,
161,
1612,
1613,
1615,
1616,
1618,
162,
1624,
1625,
1626,
1627,
1628,
1629,
1630,
1632,
1634,
1636,
1637,
1638,
1639,
164,
1640,
1641,
1643,
1644,
1645,
1646,
1647,
1648,
1654,
1655,
1656,
1657,
1658,
1659,
1660,
1663,
1667,
1668,
167,
1670,
1672,
1674,
1679,
168,
1680,
1681,
1682,
1683,
1684,
1686,
1687,
1688,
1690,
1691,
17,
1701,
1702,
1703,
1704,
1705,
1706,
1707,
1708,
1709,
171,
1714,
1715,
1716,
1717,
1718,
1719,
172,
1728,
1729,
173,
1730,
1731,
1732,
1734,
1736,
1738,
1739,
174,
1740,
1741,
1742,
1745,
1746,
1747,
1748,
1749,
175,
1750,
1751,
1752,
1754,
1755,
1756,
1757,
1758,
176,
1760,
1761,
1762,
1763,
1765,
1766,
1767,
1768,
1769,
177,
1770,
1771,
1772,
1773,
1774,
1776,
1777,
1778,
1779,
178,
1780,
1781,
1782,
1783,
1784,
1785,
1786,
1787,
1788,
1789,
179,
1790,
1793,
1795,
1799,
18,
180,
1801,
1802,
1803,
1804,
1805,
1806,
1807,
1808,
1809,
181,
1810,
1811,
1813,
1814,
1817,
1818,
1819,
182,
1820,
1821,
1822,
1823,
1824,
1825,
1826,
1827,
1828,
1829,
1830,
1832,
1842,
1843,
1844,
1846,
1849,
1850,
1851,
1852,
1854,
1855,
1856,
1858,
1859,
1860,
1861,
1864,
1872,
1873,
1874,
1875,
1876,
1877,
1879,
188,
1880,
1882,
1883,
1884,
1885,
1886,
1887,
1888,
1889,
189,
1892,
1894,
1898,
190,
1906,
1907,
1908,
1909,
191,
1910,
1911,
1912,
1913,
1914,
1915,
1916,
1918,
1919,
192,
1921,
1922,
1923,
1925,
1928,
1929,
193,
1931,
1932,
1938,
194,
1941,
1942,
1943,
1946,
1947,
1948,
1949,
195,
1950,
1951,
1952,
1953,
1955,
1956,
1957,
1958,
1959,
196,
1960,
1962,
1963,
1965,
197,
1974,
1976,
1977,
1978,
1979,
198,
1981,
1982,
1984,
1985,
1986,
1987,
1988,
1989,
199,
1990,
1991,
1992,
1993,
1994,
1996,
1997,
1999,
2,
20,
200,
2000,
2007,
2008,
2009,
201,
2011,
2012,
2013,
2014,
2016,
2018,
2019,
202,
2020,
2021,
2022,
2023,
2024,
2025,
2026,
2027,
2028,
2029,
203,
2030,
2031,
2032,
2033,
2034,
204,
2041,
2044,
2045,
2046,
2047,
2049,
205,
2050,
2051,
2053,
2054,
2055,
2056,
2057,
2058,
2059,
206,
2060,
2061,
2062,
2063,
2064,
2065,
2067,
2068,
207,
2074,
2075,
2076,
2077,
2078,
2079,
2082,
2083,
2084,
2087,
2089,
2090,
2091,
21,
210,
2106,
2107,
2109,
211,
2110,
2111,
2113,
2114,
2116,
2117,
2118,
2119,
2121,
2132,
2134,
2136,
2138,
2139,
2141,
2144,
2146,
215,
2160,
2162,
2167,
2169,
2170,
2171,
2172,
2175,
2176,
218,
2183,
2185,
2186,
2187,
219,
2193,
2194,
2195,
2196,
2199,
22,
2209,
221,
2210,
2211,
2217,
2218,
222,
223,
2235,
2237,
2238,
2239,
224,
2241,
2242,
2244,
2245,
2248,
225,
2259,
226,
2261,
2262,
2265,
2267,
2268,
227,
2270,
2273,
2274,
2275,
2286,
229,
2291,
2293,
2294,
2296,
2297,
2298,
23,
230,
2300,
2301,
2302,
2303,
231,
2310,
2311,
2312,
2314,
2321,
2322,
2323,
2324,
2325,
2326,
2327,
233,
2330,
2332,
2333,
2334,
2335,
2336,
2337,
2338,
2339,
2341,
2342,
2344,
2345,
2346,
2347,
2348,
2349,
2350,
2351,
2352,
2353,
2354,
2355,
2356,
2357,
2358,
2359,
2360,
2361,
2362,
2364,
2366,
2367,
2368,
2369,
237,
2370,
2371,
2372,
2373,
2374,
2375,
2376,
2377,
2378,
2379,
238,
2380,
2381,
2382,
2383,
2385,
2386,
2387,
2388,
2389,
239,
2391,
2392,
2393,
240,
2400,
2401,
2404,
2405,
2406,
2408,
2409,
241,
2410,
2411,
2412,
2413,
2414,
2415,
2416,
2417,
2418,
242,
2420,
2422,
2423,
2424,
2426,
2431,
2432,
2434,
2435,
2436,
2438,
244,
2441,
2442,
2443,
2444,
2445,
2446,
2447,
2448,
2449,
245,
2452,
2454,
2455,
2458,
246,
2460,
2461,
2462,
2463,
2466,
2467,
2468,
2469,
247,
2470,
2471,
2472,
2473,
2474,
2475,
2476,
248,
2480,
2481,
2482,
2483,
2484,
2485,
2487,
2488,
2489,
249,
2495,
2496,
2497,
2498,
2499,
25,
250,
2500,
2501,
2502,
2503,
2504,
2505,
2506,
2507,
251,
2512,
2513,
2518,
2519,
252,
2521,
2522,
2524,
2525,
2526,
2527,
2528,
2529,
253,
2530,
2531,
2532,
2533,
2534,
2535,
2539,
2540,
2541,
2542,
2543,
2546,
2547,
2548,
2555,
2556,
2557,
2558,
2559,
2560,
2563,
2564,
2565,
2567,
2572,
2577,
2578,
2579,
2580,
2581,
2584,
2585,
2586,
2587,
2588,
2589,
259,
2590,
2591,
2592,
2594,
2596,
2597,
2599,
26,
260,
2600,
2601,
2602,
2603,
2604,
2606,
2608,
2609,
2610,
2612,
2613,
2614,
2615,
2616,
2617,
2618,
2619,
262,
2620,
2621,
2623,
2624,
2625,
2626,
2627,
2628,
2629,
2630,
2636,
2637,
2638,
2639,
2641,
2642,
2643,
2644,
265,
2650,
2651,
2652,
2653,
2654,
2655,
2656,
2657,
2658,
2659,
266,
2660,
2661,
2662,
2663,
2665,
2666,
2667,
2668,
2669,
2670,
2676,
2677,
2679,
2680,
2681,
2682,
2683,
2686,
2688,
2689,
2690,
2695,
2698,
2699,
27,
270,
2700,
2701,
2702,
2705,
2707,
2709,
2712,
2713,
2714,
2715,
2717,
2721,
2722,
2723,
2724,
2725,
2726,
2727,
2729,
2733,
2734,
2735,
2736,
2737,
2738,
2741,
2744,
2745,
2746,
2747,
2748,
2749,
2750,
2751,
2752,
2754,
2756,
2757,
2758,
2759,
2761,
2763,
2767,
2770,
2771,
2772,
2773,
2777,
2778,
2779,
278,
2780,
2781,
2782,
2784,
2786,
2788,
2789,
279,
2791,
2792,
2793,
2794,
2795,
2796,
2797,
2799,
28,
280,
2800,
2801,
2802,
2803,
2805,
2806,
281,
2813,
2815,
2817,
2819,
282,
2822,
2823,
2824,
2827,
2828,
2829,
2831,
2833,
2834,
2836,
2838,
2839,
2842,
2843,
2844,
2845,
2847,
2848,
2849,
2854,
2855,
2856,
2857,
2859,
2860,
2861,
2862,
2863,
2865,
2868,
2869,
2870,
2873,
2874,
2875,
2876,
2877,
2878,
2879,
2880,
2881,
2882,
2883,
2884,
2885,
2887,
2889,
289,
2890,
2892,
2894,
2896,
2897,
2898,
2899,
290,
2908,
2909,
291,
2910,
2914,
2915,
2916,
2917,
2918,
2919,
292,
2921,
2924,
2929,
293,
2931,
2932,
2933,
2935,
2936,
2938,
294,
2940,
2941,
2942,
2943,
2944,
295,
2950,
2951,
2952,
2953,
2956,
2958,
2959,
2960,
2961,
2962,
2963,
2964,
2965,
2967,
2968,
297,
2971,
2972,
2973,
2974,
2975,
2976,
2978,
2979,
2980,
2982,
2983,
2984,
2987,
2988,
299,
2991,
2995,
2997,
2998,
2999,
3,
30,
3000,
3006,
3009,
3010,
302,
3021,
3022,
3023,
3024,
3025,
3026,
3027,
3028,
3029,
303,
3030,
3031,
3032,
3033,
3034,
3035,
3036,
3039,
304,
3041,
3042,
3043,
3044,
3045,
3046,
3051,
3052,
3053,
3054,
3055,
3056,
3061,
3062,
3063,
3065,
3067,
3068,
3069,
3070,
3071,
3072,
3073,
3074,
3075,
3076,
3077,
3079,
3082,
3084,
3085,
3086,
3087,
3088,
3089,
309,
3091,
3092,
3093,
3094,
3095,
3096,
3097,
3098,
3099,
31,
310,
3100,
3106,
3108,
311,
3110,
3111,
3113,
3114,
3115,
3117,
3119,
3120,
3126,
3129,
313,
3130,
3131,
3132,
3137,
3138,
3139,
3140,
3141,
3147,
3148,
3149,
315,
3151,
3153,
3154,
3155,
3156,
3157,
3158,
3159,
3161,
3165,
3166,
3167,
3168,
3169,
317,
3170,
3171,
3173,
3175,
3177,
3178,
3179,
3180,
3181,
3187,
3188,
3191,
3193,
3195,
3197,
3198,
3199,
32,
3200,
3202,
3209,
3210,
3211,
3215,
3217,
3219,
322,
3220,
3222,
3223,
3224,
323,
3231,
3232,
3233,
3235,
3236,
3237,
3238,
3239,
324,
3240,
3242,
3245,
3250,
3253,
3256,
3257,
3258,
3259,
326,
3260,
3262,
3264,
3265,
3267,
3269,
3275,
3276,
3277,
3279,
3280,
3282,
3283,
3284,
3286,
3291,
3292,
3293,
3294,
3296,
3297,
3298,
3299,
33,
3301,
3302,
3303,
3304,
3305,
3306,
3308,
3310,
3311,
3312,
3316,
3318,
3319,
3320,
3321,
3322,
3323,
3325,
3326,
3327,
3328,
3329,
333,
3330,
3331,
3332,
3333,
3334,
3335,
3336,
3337,
3338,
334,
3340,
3342,
3343,
3344,
3345,
335,
3351,
3352,
3353,
3354,
3355,
3358,
336,
3362,
3363,
3364,
3365,
3366,
3367,
3372,
3373,
3374,
3375,
3376,
3377,
338,
3384,
3385,
3386,
3387,
3388,
339,
3390,
3392,
3394,
3395,
3396,
3397,
3398,
3399,
3400,
3402,
3403,
3404,
3406,
3407,
3408,
3409,
3410,
3414,
3417,
3418,
3419,
3425,
3427,
3431,
3432,
3439,
3440,
3442,
3443,
3444,
3447,
3451,
3454,
3457,
346,
3461,
3462,
3463,
3465,
3466,
3467,
3468,
3469,
347,
3470,
3472,
3473,
3474,
348,
3483,
3484,
3485,
3486,
3487,
3488,
3489,
3490,
3491,
3493,
3494,
3496,
3498,
3499,
350,
3501,
3502,
3503,
3504,
3505,
3506,
3507,
3508,
3509,
351,
3510,
3512,
3513,
3515,
3519,
352,
3520,
3523,
3525,
3526,
3527,
3529,
353,
3531,
3538,
3539,
3541,
3543,
3545,
3547,
3551,
3552,
3559,
3560,
3561,
3562,
3563,
3565,
3568,
3569,
3571,
3575,
3579,
3583,
3584,
3585,
3586,
3587,
3588,
3589,
3591,
3596,
3597,
36,
3602,
3603,
3604,
3605,
3607,
3608,
361,
3612,
3618,
3619,
362,
3620,
3623,
3624,
3625,
3626,
3627,
3628,
3629,
3634,
3635,
3637,
3638,
3642,
3643,
3644,
3648,
3649,
365,
3650,
3653,
3656,
3658,
3659,
3661,
3662,
3669,
367,
3670,
3671,
3672,
3674,
3675,
3676,
3677,
3678,
3692,
3694,
3695,
3697,
3698,
3699,
37,
370,
3704,
3705,
3707,
3708,
3709,
371,
3710,
3711,
3712,
3724,
3725,
3726,
3727,
3728,
3729,
373,
3730,
3731,
3732,
3733,
3734,
3736,
3737,
3738,
3739,
3740,
3747,
3748,
375,
3752,
3753,
3755,
3756,
3757,
3758,
3759,
376,
3760,
3761,
3762,
3763,
3764,
3765,
3767,
3768,
3769,
377,
3770,
3777,
3782,
3788,
3789,
3790,
3791,
3792,
3793,
3794,
3796,
3797,
3798,
3799,
3804,
3805,
3813,
3815,
3816,
3818,
3819,
3820,
3822,
3824,
3825,
3826,
3827,
3828,
3829,
3830,
3833,
3835,
384,
3842,
3843,
3844,
3846,
3847,
3854,
3856,
3860,
3861,
3863,
3864,
3868,
3871,
3872,
3875,
3876,
3877,
3878,
3888,
3889,
389,
3890,
3891,
3893,
3894,
390,
3900,
3901,
3907,
3909,
391,
3910,
392,
3921,
3923,
3924,
393,
3935,
3936,
3937,
394,
3949,
395,
3952,
3953,
3954,
3955,
3957,
3965,
3966,
3967,
3968,
397,
3972,
3973,
3975,
3976,
3979,
398,
3983,
3984,
3985,
3986,
3987,
3988,
3989,
3992,
3994,
3995,
3996,
3997,
3999,
4,
40,
4000,
4002,
4003,
4004,
4005,
4009,
4011,
4012,
4013,
4015,
4017,
4018,
4020,
4021,
4022,
4024,
4026,
4027,
4029,
4030,
4031,
4032,
4035,
4036,
4037,
4039,
4041,
4042,
4043,
4044,
4045,
4047,
4050,
4051,
4054,
4055,
4056,
4058,
4061,
4063,
4065,
4069,
4070,
4071,
4072,
4076,
4077,
4079,
4080,
4081,
4082,
4085,
4086,
4087,
4089,
4090,
4091,
4093,
4094,
4095,
4099,
41,
410,
4100,
4101,
4102,
4103,
411,
4111,
4112,
4113,
4115,
4116,
4117,
4118,
4120,
4122,
4128,
4129,
4130,
4132,
4133,
4134,
4135,
414,
4143,
4144,
4147,
415,
4156,
4170,
4172,
4182,
419,
4190,
4191,
4197,
4199,
42,
421,
4211,
4213,
4217,
4219,
422,
423,
4238,
4240,
4242,
4245,
4246,
4249,
4257,
4260,
4261,
4262,
4265,
4266,
4278,
4279,
4280,
4282,
4283,
4284,
4285,
4286,
4287,
43,
430,
4306,
4307,
4308,
4309,
431,
4311,
4312,
4313,
4314,
4315,
4316,
4317,
432,
433,
4330,
4331,
4332,
4333,
4335,
4337,
4338,
4339,
434,
435,
4353,
4355,
4357,
4358,
4359,
436,
4361,
4363,
4375,
4376,
4377,
4378,
438,
4380,
4381,
4382,
4384,
4385,
4386,
4390,
4398,
4399,
44,
440,
4400,
4402,
4403,
4405,
4406,
4407,
4408,
441,
442,
4422,
4425,
4427,
4429,
443,
4430,
4432,
444,
4444,
4445,
4446,
4448,
445,
4450,
4451,
4452,
4457,
446,
4464,
4465,
4469,
447,
4470,
4471,
4472,
4473,
4474,
4476,
4480,
4481,
4482,
4485,
4491,
4499,
45,
4500,
4501,
4504,
4505,
4506,
4507,
4508,
4511,
4513,
4514,
4515,
4529,
4530,
4531,
4532,
4533,
4534,
4536,
4538,
4539,
4540,
4541,
4543,
4544,
4545,
4547,
455,
4559,
4561,
4563,
4564,
4565,
4566,
4568,
4569,
4570,
4571,
4572,
4576,
4580,
4581,
4582,
4590,
4591,
4592,
4593,
4594,
4595,
4598,
4599,
46,
4600,
4601,
4602,
4603,
4606,
461,
462,
4620,
4621,
4622,
4623,
4624,
4625,
4626,
4627,
4629,
463,
4630,
4631,
4633,
4634,
4635,
4636,
4637,
4638,
464,
4640,
465,
4652,
4654,
4655,
4656,
4658,
4659,
466,
4661,
4663,
4664,
4665,
4666,
4667,
4668,
467,
4671,
4672,
4673,
4674,
468,
4683,
4684,
4685,
4686,
4687,
4688,
4689,
469,
4690,
4692,
4693,
4694,
4695,
4697,
4698,
4699,
47,
470,
4705,
471,
4713,
4714,
4715,
4716,
4717,
4718,
4719,
472,
4720,
4721,
4722,
4723,
4724,
4725,
4727,
4728,
4729,
4731,
4732,
4733,
474,
4742,
4744,
4745,
4746,
4747,
4754,
4755,
4756,
4757,
4758,
4759,
4760,
4761,
4762,
4763,
4764,
4768,
4769,
4774,
4775,
4780,
4783,
4784,
4785,
4787,
4788,
4795,
4797,
4799,
48,
4800,
4801,
4802,
4803,
4804,
4805,
4806,
4809,
4810,
4811,
4812,
4814,
482,
4822,
4823,
4824,
4825,
4826,
4827,
4835,
4836,
4837,
4839,
4842,
4843,
4844,
4845,
4846,
4847,
4848,
4849,
485,
4850,
4858,
4862,
4863,
4864,
4866,
4867,
487,
4874,
4875,
4879,
488,
4880,
4881,
4882,
4884,
4885,
4886,
4887,
4888,
4889,
489,
4890,
4891,
4894,
4895,
4896,
49,
490,
4901,
4903,
4904,
4905,
4906,
4907,
4908,
491,
4912,
4914,
4915,
4916,
4917,
4918,
4919,
492,
4920,
4921,
4923,
4924,
4925,
4926,
4927,
4928,
4929,
493,
4930,
4931,
4936,
494,
4940,
4942,
4945,
4946,
4947,
4948,
495,
4954,
4955,
4956,
4957,
4958,
4959,
4960,
4961,
4963,
4964,
4965,
4966,
4967,
4968,
4969,
4970,
4971,
4972,
4976,
4977,
4983,
4984,
4986,
4987,
4994,
4995,
4996,
4997,
4998,
4999,
5,
50,
500,
5000,
5001,
5002,
5003,
5004,
5005,
5006,
5007,
5008,
5010,
5011,
5013,
5015,
5022,
5023,
5024,
5025,
5027,
5028,
5033,
5034,
5038,
5040,
5041,
5042,
5044,
5051,
5054,
5059,
506,
5060,
5061,
5063,
5066,
5067,
507,
5074,
5075,
5077,
5078,
508,
5080,
5083,
5087,
5088,
509,
5099,
510,
5100,
5101,
5102,
5103,
5104,
5105,
5106,
5107,
5108,
511,
5112,
512,
5121,
5122,
5123,
5124,
5126,
5129,
513,
5130,
5131,
514,
5145,
5147,
5148,
5149,
515,
5150,
516,
5169,
5170,
5171,
5172,
5173,
5174,
5175,
5176,
5178,
5179,
518,
5190,
5192,
5193,
5194,
5195,
5196,
5198,
5199,
52,
5200,
5201,
5215,
5216,
5217,
5218,
5219,
5220,
5221,
5222,
5223,
5224,
5237,
5243,
5244,
5245,
5246,
5247,
5249,
5250,
5251,
5252,
5253,
5255,
5257,
5258,
5259,
5261,
5262,
5263,
5265,
5269,
5272,
5273,
5275,
5276,
528,
5286,
5287,
5288,
5289,
5297,
5298,
53,
5300,
5301,
5302,
5303,
5304,
5305,
5306,
5307,
5309,
5310,
5311,
5312,
5314,
5318,
5319,
532,
5320,
5321,
5322,
5324,
5325,
5327,
5328,
533,
5330,
5335,
5336,
5337,
5338,
5339,
5345,
5347,
5348,
5349,
5350,
5351,
5352,
5353,
5354,
5355,
5356,
5357,
5358,
5359,
536,
5364,
5368,
5369,
537,
5374,
5377,
5378,
538,
5380,
5384,
5387,
5389,
539,
5392,
5397,
540,
5400,
5401,
5403,
5404,
5405,
5407,
541,
5410,
5411,
5412,
5413,
5414,
5415,
5416,
5417,
542,
5422,
5427,
543,
5430,
5431,
5432,
5434,
5435,
5436,
5437,
544,
545,
5451,
5452,
5453,
5454,
5455,
5456,
5457,
5458,
5459,
546,
5460,
5461,
5462,
5463,
5464,
5469,
547,
5474,
5476,
5477,
5479,
548,
5480,
5481,
5482,
5484,
5485,
5486,
5487,
5488,
5489,
549,
5490,
5491,
5492,
5494,
550,
5500,
5501,
5503,
5504,
5505,
5507,
5508,
551,
5510,
5512,
5529,
553,
5530,
5532,
5533,
5534,
5535,
5536,
5537,
5538,
5539,
554,
5540,
5541,
5542,
5543,
5544,
5545,
555,
5553,
5554,
5556,
556,
5560,
5562,
5564,
5567,
5568,
557,
5577,
558,
5580,
5582,
5583,
5584,
5586,
5588,
5589,
5590,
5591,
5592,
5593,
56,
560,
5602,
5605,
5606,
5608,
561,
5610,
5612,
5613,
5616,
5619,
562,
5626,
563,
5633,
5634,
5635,
5643,
5651,
5652,
5653,
5654,
5657,
5662,
5663,
5668,
5669,
5670,
5671,
5672,
5673,
5674,
5675,
5676,
5677,
5679,
5680,
5681,
5682,
5685,
5688,
5689,
5690,
5691,
5692,
5693,
5694,
5695,
5696,
5697,
5698,
5699,
5700,
5701,
5703,
5704,
5705,
5706,
5708,
5709,
571,
5710,
5711,
5714,
5715,
5716,
5717,
5718,
5719,
572,
5720,
5723,
5730,
5732,
5733,
5734,
5735,
5736,
5737,
5738,
5739,
574,
5740,
5741,
5742,
5744,
5745,
5746,
5747,
5748,
5749,
5750,
5751,
5752,
5753,
5754,
5756,
5757,
576,
5764,
5765,
5766,
5767,
5769,
577,
5770,
5771,
5773,
5774,
5776,
5778,
5783,
5784,
5785,
5786,
5789,
5791,
5797,
5798,
5799,
58,
5800,
5801,
5802,
5804,
5805,
5806,
5807,
5808,
5809,
5812,
5814,
5815,
5817,
5819,
582,
5820,
5821,
5823,
5824,
5825,
5826,
5829,
583,
5830,
5831,
5832,
5833,
5834,
5835,
5836,
5837,
5838,
584,
5840,
5841,
5842,
5843,
5844,
5845,
5846,
5847,
5848,
585,
5850,
5851,
5855,
5856,
5857,
5858,
5859,
586,
5861,
5862,
5863,
5864,
5865,
5866,
5867,
5868,
5869,
5871,
5872,
5873,
5875,
5876,
5877,
5878,
5880,
5881,
5882,
5883,
5884,
5885,
5886,
5887,
5889,
589,
5890,
5896,
5899,
59,
5900,
5901,
5902,
5903,
5904,
5905,
5906,
5907,
5914,
5915,
5916,
5917,
5918,
5919,
5920,
5921,
5922,
5923,
5924,
5925,
5926,
5927,
5928,
5929,
5931,
5932,
5933,
5934,
5935,
5936,
5939,
594,
5940,
5943,
5944,
5945,
5946,
5947,
5948,
5949,
5950,
5951,
5952,
5953,
5954,
596,
5961,
5962,
5963,
5964,
5965,
5966,
5969,
5973,
5974,
5975,
5976,
5977,
5978,
5979,
5980,
5981,
5982,
5983,
5986,
5989,
5997,
5998,
5999,
6,
6000,
6001,
6002,
6003,
6004,
6005,
6006,
6007,
6008,
6009,
6013,
6014,
6015,
6017,
602,
6020,
6022,
6023,
6027,
6028,
6029,
6030,
6032,
6036,
6037,
6040,
6042,
6044,
6045,
6049,
6050,
6052,
6053,
6057,
6058,
6060,
6061,
6062,
6063,
6064,
6066,
6067,
6068,
6069,
6075,
6077,
6079,
6080,
6082,
6083,
6084,
6085,
6087,
6088,
6089,
6090,
6091,
6092,
6098,
6099,
6100,
6101,
6102,
6103,
6107,
6108,
611,
6110,
6111,
6112,
6115,
6116,
6117,
6118,
6119,
612,
6120,
6121,
6122,
6123,
6124,
6125,
6129,
613,
6130,
6131,
6132,
6133,
6134,
6135,
6136,
6137,
6138,
614,
6140,
6141,
6142,
6143,
6144,
6146,
6148,
6149,
615,
6150,
6151,
6152,
6153,
6154,
6157,
6158,
6159,
616,
6160,
6161,
6162,
6163,
6168,
617,
6170,
6171,
6172,
6173,
6174,
6175,
6176,
6178,
6181,
6182,
6184,
6185,
6186,
6187,
6188,
6189,
619,
6194,
6195,
6196,
6197,
6198,
620,
6201,
6203,
6206,
6207,
6208,
621,
6210,
6211,
6213,
6214,
6217,
6218,
622,
6220,
6221,
6222,
6223,
6224,
6225,
6226,
6230,
6233,
6237,
6238,
6239,
6240,
6241,
6242,
6243,
6244,
6245,
6246,
6247,
6248,
6249,
6250,
6252,
6254,
6259,
626,
6260,
6261,
6263,
6264,
6265,
6266,
6267,
6268,
6269,
627,
6271,
6273,
6274,
6275,
6276,
6277,
6279,
6283,
6286,
6287,
6288,
6290,
6291,
6292,
6293,
6294,
6295,
6296,
6298,
6299,
630,
6300,
6301,
6303,
6304,
6305,
6306,
6312,
6313,
6314,
6316,
6317,
6318,
6319,
632,
6320,
6324,
6325,
6328,
633,
6330,
6331,
6332,
6333,
6336,
6337,
6338,
6339,
634,
6340,
6347,
6348,
6350,
6351,
6354,
6355,
6356,
6357,
6358,
6362,
6363,
6364,
6365,
6372,
6373,
6375,
6379,
6380,
6383,
6384,
6385,
6386,
6387,
6388,
6389,
6394,
6396,
6397,
6398,
6399,
64,
6400,
6401,
6403,
6405,
6406,
6407,
6410,
6415,
6416,
6417,
6418,
6420,
6424,
6425,
6426,
6427,
6428,
6429,
643,
6430,
6431,
6432,
6433,
6434,
6435,
6436,
6438,
644,
6441,
6442,
6443,
6448,
6450,
6452,
6454,
6455,
6456,
6464,
6466,
6467,
6471,
6472,
6473,
6474,
6475,
6476,
6478,
6480,
6481,
6482,
6483,
6484,
6485,
6489,
6491,
6493,
6494,
6497,
6499,
6500,
6502,
6510,
6512,
6515,
6517,
6518,
6523,
653,
6530,
654,
655,
6557,
656,
657,
6570,
6577,
658,
659,
66,
660,
6604,
661,
6611,
6612,
6613,
6614,
6615,
6617,
662,
6624,
663,
664,
6645,
6653,
667,
67,
671,
6729,
6732,
6733,
6736,
674,
6747,
6748,
675,
6753,
678,
6782,
6785,
6786,
6788,
679,
6790,
6795,
68,
680,
6804,
6805,
6808,
6816,
6821,
6822,
6824,
6825,
683,
6833,
6834,
6836,
6838,
6839,
684,
6841,
6860,
6864,
6865,
6866,
6867,
687,
688,
6883,
6885,
6886,
6887,
6888,
6898,
6900,
6905,
6908,
6912,
6918,
692,
6924,
6925,
6926,
6928,
6929,
693,
6931,
6933,
694,
6944,
695,
6958,
696,
6968,
6969,
6973,
6975,
6976,
698,
699,
6993,
6994,
6995,
6996,
7,
700,
7001,
7004,
701,
7019,
702,
7022,
703,
7046,
7047,
7048,
7049,
705,
7051,
706,
7060,
707,
708,
709,
7094,
71,
711,
712,
716,
718,
72,
720,
721,
723,
725,
727,
730,
733,
734,
735,
736,
737,
738,
739,
7390,
74,
740,
741,
742,
743,
7489,
75,
750,
753,
754,
7546,
755,
7554,
7555,
7556,
758,
7590,
7591,
76,
760,
761,
7614,
7625,
7627,
7628,
7633,
765,
767,
7674,
7736,
774,
7742,
775,
776,
777,
779,
78,
780,
7800,
781,
782,
783,
784,
787,
788,
79,
7902,
791,
792,
793,
794,
795,
796,
797,
798,
8,
80,
800,
801,
804,
81,
811,
812,
813,
815,
816,
817,
819,
82,
821,
822,
826,
829,
83,
830,
831,
832,
834,
874,
877,
878,
879,
882,
883,
884,
885,
886,
888,
89,
890,
892,
895,
896,
897,
898,
9,
90,
900,
901,
902,
904,
905,
91,
910,
913,
916,
917,
918,
919,
92,
920,
921,
922,
923,
924,
926,
928,
929,
93,
930,
938,
939,
94,
943,
944,
946,
95,
950,
951,
952,
953,
956,
957,
958,
959,
96,
960,
963,
964,
965,
966,
967,
969,
97,
970,
974,
975,
977,
978,
835,
838,
839,
84,
840,
843,
844,
845,
849,
85,
850,
852,
853,
854,
858,
859,
86,
862,
864,
865,
867,
868,
869,
871,
872,
873,
98,
980,
981,
982,
99,
992,
993,
994,
995,
996,
997) AND al.ID_LISTAPRECIO =8;


select * from dbafv.articulos_lpv al where al.ID_LISTAPRECIO =8;

select * from dbafv.articulos_lpv al where al.ID_LISTAPRECIO =8 and IDARTICULO =133;

select IDARTICULO , PRECIOLISTA ,FECHAOPERACION  from dbafv.articulos_lpv al where al.ID_LISTAPRECIO =8 and IDARTICULO in (
1,
10,
100,
101,
102,
103,
104,
106,
107,
108,
109,
11,
110,
111,
112,
113,
114,
115,
116,
12,
122,
123,
125,
128,
13,
130,
132,
133,
134,
136,
137,
14,
140,
141,
142,
143,
145,
147,
148,
149,
15,
150,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
164,
167,
168,
17,
171,
172,
173,
174,
175,
176,
177,
178,
179,
18,
180,
181,
182,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
2,
20,
200,
201,
202,
203,
204,
205,
206,
207,
21,
210,
211,
215,
218,
219,
22,
221,
222,
223,
224,
225,
226,
227,
229,
23,
230,
231,
233,
237,
238,
239,
240,
241,
242,
244,
245,
246,
247,
248,
249,
25,
250,
251,
252,
253,
259,
26,
260,
262,
265,
266,
27,
270,
278,
279,
28,
280,
281,
282,
289,
290,
291,
292,
293,
294,
295,
297,
299,
3,
30,
302,
303,
304,
309,
31,
310,
311,
313,
315,
317,
32,
322,
323,
324,
326,
33,
333,
334,
335,
336,
338,
339,
346,
347,
348,
350,
351,
352,
353,
36,
361,
362,
365,
367,
37,
370,
371,
373,
375,
376,
377,
384,
389,
390,
391,
392,
393,
394,
395,
397,
398,
4,
40,
41,
410,
411,
414,
415,
419,
42,
421,
422,
423,
43,
430,
431,
432,
433,
434,
435,
436,
438,
44,
440,
441,
442,
443,
444,
445,
446,
447,
45,
455,
46,
461,
462,
463,
464,
465,
466,
467,
468,
469,
47,
470,
471,
472,
474,
48,
482,
485,
487,
488,
489,
49,
490,
491,
492,
493,
494,
495,
5,
50,
500,
506,
507,
508,
509,
510,
511,
512,
513,
514,
515,
516,
518,
52,
528,
53,
532,
533,
536,
537,
538,
539,
540,
541,
542,
543,
544,
545,
546,
547,
548,
549,
550,
551,
553,
554,
555,
556,
557,
558,
56,
560,
561,
562,
563,
571,
572,
574,
576,
577,
58,
582,
583,
584,
585,
586,
589,
59,
594,
596,
6,
602,
611,
612,
613,
614,
615,
616,
617,
619,
620,
621,
622,
626,
627,
630,
632,
633,
634,
64,
643,
644,
653,
654,
655,
656,
657,
658,
659,
66,
660,
661,
662,
663,
664,
667,
67,
671,
674,
675,
678,
679,
68,
680,
683,
684,
687,
688,
692,
693,
694,
695,
696,
698,
699,
7,
700,
701,
702,
703,
705,
706,
707,
708,
709,
71,
711,
712,
716,
718,
72,
720,
721,
723,
725,
727,
730,
733,
734,
735,
736,
737,
738,
739,
74,
740,
741,
742,
743,
75,
750,
753,
754,
755,
758,
76,
760,
761,
765,
767,
774,
775,
776,
777,
779,
78,
780,
781,
782,
783,
784,
787,
788,
79,
791,
792,
793,
794,
795,
796,
797,
798,
8,
80,
800,
801,
804,
81,
811,
812,
813,
815,
816,
817,
819,
82,
821,
822,
826,
829,
83,
830,
831,
832,
834,
835,
838,
839,
84,
840,
843,
844,
845,
849,
85,
850,
852,
853,
854,
858,
859,
86,
862,
864,
865,
89,
9,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99
);


select * from dbafv.anexo a 
where (a.IDANEXO,a.IDZONA , a.USUARIOCREACION  ) in ((60215,211,'v0004')) #30262042

select * from dbafv.anexo a INNER join dbafv.anexodetalle a2 
where (a.IDANEXO,a.IDZONA , a.USUARIOCREACION  ) in ((60121, 229,'v0553'));

SELECT
ANEXO.IDANEXO AS id_documento_afv,
ANEXO.USUARIOCREACION AS USUARIO_CREACION,
ANEXO.IDZONA AS ID_ZONA,
ZONAS.NOMBREZONA AS NOMBRE_ZONA,
COLABORADORES.NOMBRE1COLABORADOR AS VENDEDOR,
ANEXO.FECHAEMISIONANEXO AS FECHA_DOCUMENTO,
ANEXO.NUMEROPLANILLA AS REFERENCIA,
ENTIDADFINANCIERA.NOMBRECORTO AS BANCO,
CUENTABANCARIAINTERNA.NUMEROCUENTABANCARIA AS NUMERO_CUENTA_BANCARIA,
ANEXO.IDMONEDA AS ID_MONEDA,
anexo .IDCUENTABANCARIA as ID_CUENTA_BANCARIA,
MONEDAS.ABREVIACION AS MONEDA,
anexo.TOTALANEXO as monto,
CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('ID', CLIENTE.IDCLIENTE,'CODIGO_DE_CLIENTE',CLIENTE.CODNEMONICO,'RIF_CLIENTE', CLIENTE.RIF,'RAZON_SOCIAL_CLIENTE',CLIENTE.RAZONSOCIAL ) ), ']') AS JSON) AS CLIENTES,
CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('DOCUMENTO', ANEXODETALLE.IDRECIBOPAGO,'concatenado',CONCAT('R', SUBSTRING(ANEXODETALLE.USUARIOCREACION, 2), SUBSTRING(zonas.CODIGOZONA, 2), DATE_FORMAT(r.FECHACREACION, '%y%m%d'), anexodetalle.IDRECIBOPAGO), 'MONTO', CAST( ANEXODETALLE.MONTO AS CHAR),'MONTO_EDITADO', CAST(ANEXODETALLE.MONTO_D AS CHAR) ) ), ']') AS JSON) AS DOCUMENTOS_ASOCIADOS
FROM ANEXO
INNER JOIN ANEXODETALLE AS ANEXODETALLE ON ANEXO.IDANEXO = ANEXODETALLE.IDANEXO AND ANEXO.IDZONA = ANEXODETALLE.IDZONA AND ANEXO.USUARIOCREACION = ANEXODETALLE.USUARIOCREACION
LEFT JOIN COLABORADORES ON ANEXO.IDCOLABORADOR = COLABORADORES.IDCOLABORADORES
LEFT JOIN ZONAS AS ZONAS ON ANEXO.IDZONA = ZONAS.IDZONAS
LEFT JOIN CUENTABANCARIAINTERNA AS CUENTABANCARIAINTERNA ON ANEXO.IDCUENTABANCARIA = CUENTABANCARIAINTERNA.IDCUENTABANCARIA
LEFT JOIN ENTIDADFINANCIERA AS ENTIDADFINANCIERA ON CUENTABANCARIAINTERNA.IDENTIDADFINANCIERA = ENTIDADFINANCIERA.IDENTIDADFINANCIERA
LEFT JOIN MONEDAS AS MONEDAS ON MONEDAS.IDMONEDA = ANEXO.IDMONEDA
LEFT JOIN CLIENTE ON ANEXODETALLE.IDCLIENTE = CLIENTE.IDCLIENTE
inner JOIN recibo r ON (r.IDRECIBO = ANEXODETALLE.IDRECIBOPAGO AND r.IDZONA = ANEXODETALLE.IDZONA AND r.USUARIOCREACION = ANEXODETALLE.USUARIOCREACION) 
	WHERE
	(ANEXO.IDANEXO,ANEXO.IDZONA, ANEXO.USUARIOCREACION) IN ((60349,254,'v0007'))
GROUP BY ANEXO.IDANEXO, ANEXO.IDZONA,ANEXO.USUARIOCREACION;

[
{"MONTO": "77.0000", "DOCUMENTO": 60550, 
"concatenado": "R000700723062460550", "MONTO_EDITADO": null}, 

{"MONTO": "61.0000", "DOCUMENTO": 60551, 
"concatenado": "R000700723062460551", "MONTO_EDITADO": null}, 

{"MONTO": "29.0000", "DOCUMENTO": 60552, 
"concatenado": "R000700723062460552", "MONTO_EDITADO": null}
]

# consulta de anexo y su detalle
SELECT 
	CONCAT('A', SUBSTRING(a.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(a.FECHACREACION, '%y%m%d'), a.IDANEXO) AS codigo_documento,
	CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('DOCUMENTO', CONCAT('R', SUBSTRING(ad.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(r.FECHACREACION, '%y%m%d'), ad.IDRECIBOPAGO) ) ), ']') AS JSON) AS DOCUMENTOS_ASOCIADOS
FROM anexo AS a 
INNER JOIN anexodetalle AS ad USING (IDANEXO, IDZONA, USUARIOCREACION) 
INNER JOIN zonas z ON (z.IDZONAS = ad.IDZONA) 
inner JOIN recibo r ON (r.IDRECIBO = ad.IDRECIBOPAGO AND r.IDZONA = ad.IDZONA AND r.USUARIOCREACION = ad.USUARIOCREACION) 
WHERE 
    (a.IDANEXO,a.IDZONA, a.USUARIOCREACION) IN (
(60215, 211, 'v0004'),
(60081, 221, 'v0005'),
(60082, 221, 'v0005'),
(60084, 221, 'v0005'),
(60085, 221, 'v0005'),
(60092, 221, 'v0005'),
(60093, 221, 'v0005'),
(60105, 221, 'v0005'),
(60127, 221, 'v0005'),
(60174, 221, 'v0005'),
(60180, 221, 'v0005'),
(60185, 221, 'v0005'),
(60196, 221, 'v0005'),
(60297, 221, 'v0005'),
(60308, 221, 'v0005'),
(60132, 76, 'v0005'),
(60139, 76, 'v0005'),
(60349, 254, 'v0007'),
(60059, 262, 'v0008'),
(60166, 262, 'v0008'),
(60167, 262, 'v0008'),
(60168, 262, 'v0008'),
(60185, 262, 'v0008'),
(60214, 262, 'v0008'),
(60216, 262, 'v0008'),
(60217, 262, 'v0008'),
(60219, 262, 'v0008'),
(60229, 262, 'v0008'),
(60240, 262, 'v0008'),
(60241, 262, 'v0008'),
(60242, 262, 'v0008'),
(60244, 262, 'v0008'),
(60264, 262, 'v0008'),
(60265, 262, 'v0008'),
(60267, 262, 'v0008'),
(60269, 262, 'v0008'),
(60312, 262, 'v0008'),
(60313, 262, 'v0008'),
(60314, 262, 'v0008'),
(60318, 262, 'v0008'),
(60319, 262, 'v0008'),
(60320, 262, 'v0008'),
(60322, 262, 'v0008'),
(60323, 262, 'v0008'),
(60324, 262, 'v0008'),
(60047, 10, 'v0011'),
(60059, 10, 'v0011'),
(60063, 10, 'v0011'),
(60070, 10, 'v0011'),
(60136, 31, 'v0013'),
(60140, 31, 'v0013'),
(60181, 201, 'v0032'),
(60185, 201, 'v0032'),
(60112, 214, 'v0043'),
(60113, 214, 'v0043'),
(60114, 214, 'v0043'),
(60105, 8, 'v0043'),
(60106, 8, 'v0043'),
(60108, 25, 'v0043'),
(60304, 217, 'v0046'),
(60319, 217, 'v0046'),
(60335, 217, 'v0046'),
(60383, 217, 'v0046'),
(60384, 217, 'v0046'),
(60414, 217, 'v0046'),
(60020, 223, 'v0051'),
(60072, 223, 'v0051'),
(60106, 223, 'v0051'),
(60112, 223, 'v0051'),
(60121, 223, 'v0051'),
(60124, 223, 'v0051'),
(60216, 223, 'v0051'),
(60217, 223, 'v0051'),
(60107, 242, 'v0059'),
(60153, 242, 'v0059'),
(60155, 242, 'v0059'),
(60161, 242, 'v0059'),
(60165, 242, 'v0059'),
(60166, 242, 'v0059'),
(60168, 242, 'v0059'),
(60172, 242, 'v0059'),
(60173, 242, 'v0059'),
(60177, 242, 'v0059'),
(60181, 242, 'v0059'),
(60182, 242, 'v0059'),
(60186, 242, 'v0059'),
(60206, 242, 'v0059'),
(60209, 242, 'v0059'),
(60210, 242, 'v0059'),
(60213, 242, 'v0059'),
(60216, 242, 'v0059'),
(60217, 242, 'v0059'),
(60218, 242, 'v0059'),
(60219, 242, 'v0059'),
(60220, 242, 'v0059'),
(60221, 242, 'v0059'),
(60222, 242, 'v0059'),
(60227, 242, 'v0059'),
(60228, 242, 'v0059'),
(60232, 242, 'v0059'),
(60234, 242, 'v0059'),
(60239, 242, 'v0059'),
(60240, 242, 'v0059'),
(60243, 242, 'v0059'),
(60244, 242, 'v0059'),
(60247, 242, 'v0059'),
(60252, 242, 'v0059'),
(60291, 242, 'v0059'),
(60292, 242, 'v0059'),
(60319, 242, 'v0059'),
(60321, 242, 'v0059'),
(60114, 248, 'v0064'),
(60115, 248, 'v0064'),
(60116, 248, 'v0064'),
(60140, 248, 'v0064'),
(60148, 248, 'v0064'),
(60151, 248, 'v0064'),
(60152, 248, 'v0064'),
(60153, 248, 'v0064'),
(60164, 248, 'v0064'),
(60165, 248, 'v0064'),
(60167, 248, 'v0064'),
(60168, 248, 'v0064'),
(60169, 248, 'v0064'),
(60195, 248, 'v0064'),
(60196, 248, 'v0064'),
(60197, 248, 'v0064'),
(60310, 248, 'v0064'),
(60311, 248, 'v0064'),
(60312, 248, 'v0064'),
(60314, 248, 'v0064'),
(60315, 248, 'v0064'),
(60171, 253, 'v0069'),
(60298, 253, 'v0069'),
(60121, 256, 'v0072'),
(60122, 256, 'v0072'),
(60128, 258, 'v0075'),
(60129, 258, 'v0075'),
(60130, 258, 'v0075'),
(60131, 258, 'v0075'),
(60132, 258, 'v0075'),
(60133, 258, 'v0075'),
(60134, 258, 'v0075'),
(60135, 258, 'v0075'),
(60136, 258, 'v0075'),
(60138, 258, 'v0075'),
(60139, 258, 'v0075'),
(60140, 258, 'v0075'),
(60141, 258, 'v0075'),
(60141, 260, 'v0077'),
(60147, 260, 'v0077'),
(60187, 260, 'v0077'),
(60076, 261, 'v0079'),
(60081, 278, 'v0092'),
(60087, 278, 'v0092'),
(60118, 6, 'v0105'),
(60138, 6, 'v0105'),
(60152, 6, 'v0105'),
(60312, 7, 'v0106'),
(60313, 7, 'v0106'),
(60314, 7, 'v0106'),
(60315, 7, 'v0106'),
(60189, 12, 'v0111'),
(60143, 29, 'v0128'),
(60163, 29, 'v0128'),
(60165, 29, 'v0128'),
(60217, 29, 'v0128'),
(60113, 32, 'v0130'),
(60116, 32, 'v0130'),
(60117, 32, 'v0130'),
(60122, 32, 'v0130'),
(60128, 32, 'v0130'),
(60185, 32, 'v0130'),
(60193, 32, 'v0130'),
(60194, 32, 'v0130'),
(60195, 32, 'v0130'),
(60201, 32, 'v0130'),
(60284, 32, 'v0130'),
(60302, 32, 'v0130'),
(60321, 32, 'v0130'),
(60324, 32, 'v0130'),
(60098, 44, 'v0143'),
(60215, 54, 'v0154'),
(60094, 275, 'v0168'),
(60095, 275, 'v0168'),
(60162, 66, 'v0168'),
(60163, 66, 'v0168'),
(60165, 66, 'v0168'),
(60166, 66, 'v0168'),
(60181, 66, 'v0168'),
(60232, 66, 'v0168'),
(60297, 66, 'v0168'),
(60298, 66, 'v0168'),
(60109, 75, 'v0181'),
(60110, 75, 'v0181'),
(60206, 75, 'v0181'),
(60222, 75, 'v0181'),
(60083, 76, 'v0182'),
(60084, 76, 'v0182'),
(60085, 76, 'v0182'),
(60088, 76, 'v0182'),
(60089, 76, 'v0182'),
(60094, 76, 'v0182'),
(60120, 76, 'v0182'),
(60111, 80, 'v0187'),
(60112, 80, 'v0187'),
(60126, 80, 'v0187'),
(60127, 80, 'v0187'),
(60132, 80, 'v0187'),
(60133, 80, 'v0187'),
(60138, 80, 'v0187'),
(60142, 80, 'v0187'),
(60143, 80, 'v0187'),
(60148, 80, 'v0187'),
(60149, 80, 'v0187'),
(60154, 80, 'v0187'),
(60155, 80, 'v0187'),
(60156, 80, 'v0187'),
(60157, 80, 'v0187'),
(60159, 80, 'v0187'),
(60176, 80, 'v0187'),
(60197, 80, 'v0187'),
(60199, 80, 'v0187'),
(60207, 80, 'v0187'),
(60143, 198, 'v0309'),
(60196, 200, 'v0312'),
(60121, 229, 'v0553'),
(60143, 7, 'v0887'),
(60144, 7, 'v0887'),
(60164, 7, 'v0887'),
(60167, 7, 'v0887'),
(60168, 7, 'v0887'),
(60169, 7, 'v0887'),
(60170, 7, 'v0887'),
(60171, 7, 'v0887'),
(60172, 7, 'v0887'),
(60173, 7, 'v0887'),
(60059, 75, 'v0887'),
(60060, 75, 'v0887'),
(60061, 75, 'v0887'),
(60062, 75, 'v0887'),
(60063, 75, 'v0887'),
(60064, 75, 'v0887'),
(60090, 75, 'v0887'),
(60091, 75, 'v0887'),
(60092, 75, 'v0887')
   )
  GROUP BY a.IDANEXO, a.IDZONA,a.USUARIOCREACION
   ;
  

 
  
SELECT 
	CONCAT('A', SUBSTRING(a.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(a.FECHACREACION, '%y%m%d'), a.IDANEXO) AS codigo_documento,
		CONCAT(
			GROUP_CONCAT( 
				DISTINCT 
					CONCAT(
						'R', 
						SUBSTRING(ad.USUARIOCREACION, 2), 
						SUBSTRING(z.CODIGOZONA, 2), 
						DATE_FORMAT(r.FECHACREACION, '%y%m%d'), 
						ad.IDRECIBOPAGO
					)
				)
		) AS DOCUMENTOS_ASOCIADOS
FROM anexo AS a 
INNER JOIN anexodetalle AS ad USING (IDANEXO, IDZONA, USUARIOCREACION) 
INNER JOIN zonas z ON (z.IDZONAS = ad.IDZONA) 
inner JOIN recibo r ON (r.IDRECIBO = ad.IDRECIBOPAGO AND r.IDZONA = ad.IDZONA AND r.USUARIOCREACION = ad.USUARIOCREACION) 
WHERE 
    (a.IDANEXO,a.IDZONA, a.USUARIOCREACION) IN ((60349,254,'v0007'))
     GROUP BY a.IDANEXO, a.IDZONA,a.USUARIOCREACION
    ;
   
   
SELECT 
a.idanexo as idanexo,
r.IDRECEPTORRECIBO,
c.RIF,
c.RAZONSOCIAL,
concat("(",a.IDANEXO,",", a.idzona,", '", a.usuariocreacion,"'),") as keyrow,
SUBSTRING(a.NUMEROPLANILLA,-8) as referencia,
	CONCAT('A', SUBSTRING(a.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(a.FECHACREACION, '%y%m%d'), a.IDANEXO) AS codigo_documento,
	#CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('DOCUMENTO', CONCAT('R', SUBSTRING(ad.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(r.FECHACREACION, '%y%m%d'), ad.IDRECIBOPAGO) ) ), ']') AS JSON) AS DOCUMENTOS_ASOCIADOS,
	CONCAT(
		GROUP_CONCAT( 
			DISTINCT 
				CONCAT(
					'R', 
					SUBSTRING(ad.USUARIOCREACION, 2), 
					SUBSTRING(z.CODIGOZONA, 2), 
					DATE_FORMAT(r.FECHACREACION, '%y%m%d'), 
					ad.IDRECIBOPAGO
				)
			)
	) AS DOCUMENTOS_ASOCIADOS
FROM anexo AS a 
INNER JOIN anexodetalle AS ad USING (IDANEXO, IDZONA, USUARIOCREACION) 
INNER JOIN zonas z ON (z.IDZONAS = ad.IDZONA) 
inner JOIN recibo r ON (r.IDRECIBO = ad.IDRECIBOPAGO AND r.IDZONA = ad.IDZONA AND r.USUARIOCREACION = ad.USUARIOCREACION) 
inner join  CLIENTE c on r.IDRECEPTORRECIBO=c.IDCLIENTE
WHERE 
    (a.IDANEXO,a.IDZONA, a.USUARIOCREACION) IN (
(60215, 211, 'v0004'),
(60081, 221, 'v0005'),
(60082, 221, 'v0005'),
(60084, 221, 'v0005'),
(60085, 221, 'v0005'),
(60092, 221, 'v0005'),
(60093, 221, 'v0005'),
(60105, 221, 'v0005'),
(60127, 221, 'v0005'),
(60174, 221, 'v0005'),
(60180, 221, 'v0005'),
(60185, 221, 'v0005'),
(60196, 221, 'v0005'),
(60297, 221, 'v0005'),
(60308, 221, 'v0005'),
(60132, 76, 'v0005'),
(60139, 76, 'v0005'),
(60349, 254, 'v0007'),
(60059, 262, 'v0008'),
(60166, 262, 'v0008'),
(60167, 262, 'v0008'),
(60168, 262, 'v0008'),
(60185, 262, 'v0008'),
(60214, 262, 'v0008'),
(60216, 262, 'v0008'),
(60217, 262, 'v0008'),
(60219, 262, 'v0008'),
(60229, 262, 'v0008'),
(60240, 262, 'v0008'),
(60241, 262, 'v0008'),
(60242, 262, 'v0008'),
(60244, 262, 'v0008'),
(60264, 262, 'v0008'),
(60265, 262, 'v0008'),
(60267, 262, 'v0008'),
(60269, 262, 'v0008'),
(60312, 262, 'v0008'),
(60313, 262, 'v0008'),
(60314, 262, 'v0008'),
(60318, 262, 'v0008'),
(60319, 262, 'v0008'),
(60320, 262, 'v0008'),
(60322, 262, 'v0008'),
(60323, 262, 'v0008'),
(60324, 262, 'v0008'),
(60047, 10, 'v0011'),
(60059, 10, 'v0011'),
(60063, 10, 'v0011'),
(60070, 10, 'v0011'),
(60136, 31, 'v0013'),
(60140, 31, 'v0013'),
(60181, 201, 'v0032'),
(60185, 201, 'v0032'),
(60112, 214, 'v0043'),
(60113, 214, 'v0043'),
(60114, 214, 'v0043'),
(60105, 8, 'v0043'),
(60106, 8, 'v0043'),
(60108, 25, 'v0043'),
(60304, 217, 'v0046'),
(60319, 217, 'v0046'),
(60335, 217, 'v0046'),
(60383, 217, 'v0046'),
(60384, 217, 'v0046'),
(60414, 217, 'v0046'),
(60020, 223, 'v0051'),
(60072, 223, 'v0051'),
(60106, 223, 'v0051'),
(60112, 223, 'v0051'),
(60121, 223, 'v0051'),
(60124, 223, 'v0051'),
(60216, 223, 'v0051'),
(60217, 223, 'v0051'),
(60107, 242, 'v0059'),
(60153, 242, 'v0059'),
(60155, 242, 'v0059'),
(60161, 242, 'v0059'),
(60165, 242, 'v0059'),
(60166, 242, 'v0059'),
(60168, 242, 'v0059'),
(60172, 242, 'v0059'),
(60173, 242, 'v0059'),
(60177, 242, 'v0059'),
(60181, 242, 'v0059'),
(60182, 242, 'v0059'),
(60186, 242, 'v0059'),
(60206, 242, 'v0059'),
(60209, 242, 'v0059'),
(60210, 242, 'v0059'),
(60213, 242, 'v0059'),
(60216, 242, 'v0059'),
(60217, 242, 'v0059'),
(60218, 242, 'v0059'),
(60219, 242, 'v0059'),
(60220, 242, 'v0059'),
(60221, 242, 'v0059'),
(60222, 242, 'v0059'),
(60227, 242, 'v0059'),
(60228, 242, 'v0059'),
(60232, 242, 'v0059'),
(60234, 242, 'v0059'),
(60239, 242, 'v0059'),
(60240, 242, 'v0059'),
(60243, 242, 'v0059'),
(60244, 242, 'v0059'),
(60247, 242, 'v0059'),
(60252, 242, 'v0059'),
(60291, 242, 'v0059'),
(60292, 242, 'v0059'),
(60319, 242, 'v0059'),
(60321, 242, 'v0059'),
(60114, 248, 'v0064'),
(60115, 248, 'v0064'),
(60116, 248, 'v0064'),
(60140, 248, 'v0064'),
(60148, 248, 'v0064'),
(60151, 248, 'v0064'),
(60152, 248, 'v0064'),
(60153, 248, 'v0064'),
(60164, 248, 'v0064'),
(60165, 248, 'v0064'),
(60167, 248, 'v0064'),
(60168, 248, 'v0064'),
(60169, 248, 'v0064'),
(60195, 248, 'v0064'),
(60196, 248, 'v0064'),
(60197, 248, 'v0064'),
(60310, 248, 'v0064'),
(60311, 248, 'v0064'),
(60312, 248, 'v0064'),
(60314, 248, 'v0064'),
(60315, 248, 'v0064'),
(60171, 253, 'v0069'),
(60298, 253, 'v0069'),
(60121, 256, 'v0072'),
(60122, 256, 'v0072'),
(60128, 258, 'v0075'),
(60129, 258, 'v0075'),
(60130, 258, 'v0075'),
(60131, 258, 'v0075'),
(60132, 258, 'v0075'),
(60133, 258, 'v0075'),
(60134, 258, 'v0075'),
(60135, 258, 'v0075'),
(60136, 258, 'v0075'),
(60138, 258, 'v0075'),
(60139, 258, 'v0075'),
(60140, 258, 'v0075'),
(60141, 258, 'v0075'),
(60141, 260, 'v0077'),
(60147, 260, 'v0077'),
(60187, 260, 'v0077'),
(60076, 261, 'v0079'),
(60081, 278, 'v0092'),
(60087, 278, 'v0092'),
(60118, 6, 'v0105'),
(60138, 6, 'v0105'),
(60152, 6, 'v0105'),
(60312, 7, 'v0106'),
(60313, 7, 'v0106'),
(60314, 7, 'v0106'),
(60315, 7, 'v0106'),
(60189, 12, 'v0111'),
(60143, 29, 'v0128'),
(60163, 29, 'v0128'),
(60165, 29, 'v0128'),
(60217, 29, 'v0128'),
(60113, 32, 'v0130'),
(60116, 32, 'v0130'),
(60117, 32, 'v0130'),
(60122, 32, 'v0130'),
(60128, 32, 'v0130'),
(60185, 32, 'v0130'),
(60193, 32, 'v0130'),
(60194, 32, 'v0130'),
(60195, 32, 'v0130'),
(60201, 32, 'v0130'),
(60284, 32, 'v0130'),
(60302, 32, 'v0130'),
(60321, 32, 'v0130'),
(60324, 32, 'v0130'),
(60098, 44, 'v0143'),
(60215, 54, 'v0154'),
(60094, 275, 'v0168'),
(60095, 275, 'v0168'),
(60162, 66, 'v0168'),
(60163, 66, 'v0168'),
(60165, 66, 'v0168'),
(60166, 66, 'v0168'),
(60181, 66, 'v0168'),
(60232, 66, 'v0168'),
(60297, 66, 'v0168'),
(60298, 66, 'v0168'),
(60109, 75, 'v0181'),
(60110, 75, 'v0181'),
(60206, 75, 'v0181'),
(60222, 75, 'v0181'),
(60083, 76, 'v0182'),
(60084, 76, 'v0182'),
(60085, 76, 'v0182'),
(60088, 76, 'v0182'),
(60089, 76, 'v0182'),
(60094, 76, 'v0182'),
(60120, 76, 'v0182'),
(60111, 80, 'v0187'),
(60112, 80, 'v0187'),
(60126, 80, 'v0187'),
(60127, 80, 'v0187'),
(60132, 80, 'v0187'),
(60133, 80, 'v0187'),
(60138, 80, 'v0187'),
(60142, 80, 'v0187'),
(60143, 80, 'v0187'),
(60148, 80, 'v0187'),
(60149, 80, 'v0187'),
(60154, 80, 'v0187'),
(60155, 80, 'v0187'),
(60156, 80, 'v0187'),
(60157, 80, 'v0187'),
(60159, 80, 'v0187'),
(60176, 80, 'v0187'),
(60197, 80, 'v0187'),
(60199, 80, 'v0187'),
(60207, 80, 'v0187'),
(60143, 198, 'v0309'),
(60196, 200, 'v0312'),
(60121, 229, 'v0553'),
(60143, 7, 'v0887'),
(60144, 7, 'v0887'),
(60164, 7, 'v0887'),
(60167, 7, 'v0887'),
(60168, 7, 'v0887'),
(60169, 7, 'v0887'),
(60170, 7, 'v0887'),
(60171, 7, 'v0887'),
(60172, 7, 'v0887'),
(60173, 7, 'v0887'),
(60059, 75, 'v0887'),
(60060, 75, 'v0887'),
(60061, 75, 'v0887'),
(60062, 75, 'v0887'),
(60063, 75, 'v0887'),
(60064, 75, 'v0887'),
(60090, 75, 'v0887'),
(60091, 75, 'v0887'),
(60092, 75, 'v0887')
   )
  GROUP BY a.IDANEXO, a.IDZONA,a.USUARIOCREACION
   ;


  select * from anexo a where a.NUMEROPLANILLA like '%91320246';

SELECT 
    CONCAT('R', SUBSTRING(ad.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(r.FECHACREACION, '%y%m%d'), ad.IDRECIBOPAGO) AS DOCUMENTO, 
    ad.MONTO AS MONTO 
FROM anexodetalle AS ad 
INNER join anexo  a ON (a.IDANEXO = ad.IDANEXO AND a.IDZONA = ad.IDZONA AND a.USUARIOCREACION = ad.USUARIOCREACION) 
INNER JOIN zonas z ON (z.IDZONAS = ad.IDZONA) 
INNER JOIN recibo r ON (r.IDRECIBO = ad.IDRECIBOPAGO AND r.IDZONA = ad.IDZONA AND r.USUARIOCREACION = ad.USUARIOCREACION) 
WHERE 
(AD.IDANEXO,AD.IDZONA, AD.USUARIOCREACION) IN ((60121, 229,'v0553'));



SELECT 
a.idanexo as idanexo,
r.IDRECEPTORRECIBO,
c.RIF,
c.RAZONSOCIAL,
concat("(",a.IDANEXO,",", a.idzona,", '", a.usuariocreacion,"'),") as keyrow,
SUBSTRING(a.NUMEROPLANILLA,-8) as referencia,
	CONCAT('A', SUBSTRING(a.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(a.FECHACREACION, '%y%m%d'), a.IDANEXO) AS codigo_documento,
	#CAST( CONCAT('[', GROUP_CONCAT( DISTINCT JSON_OBJECT('DOCUMENTO', CONCAT('R', SUBSTRING(ad.USUARIOCREACION, 2), SUBSTRING(z.CODIGOZONA, 2), DATE_FORMAT(r.FECHACREACION, '%y%m%d'), ad.IDRECIBOPAGO) ) ), ']') AS JSON) AS DOCUMENTOS_ASOCIADOS,
	CONCAT(
		GROUP_CONCAT( 
			DISTINCT 
				CONCAT(
					'R', 
					SUBSTRING(ad.USUARIOCREACION, 2), 
					SUBSTRING(z.CODIGOZONA, 2), 
					DATE_FORMAT(r.FECHACREACION, '%y%m%d'), 
					ad.IDRECIBOPAGO
				)
			)
	) AS DOCUMENTOS_ASOCIADOS
FROM anexo AS a 
INNER JOIN anexodetalle AS ad USING (IDANEXO, IDZONA, USUARIOCREACION) 
INNER JOIN zonas z ON (z.IDZONAS = ad.IDZONA) 
inner JOIN recibo r ON (r.IDRECIBO = ad.IDRECIBOPAGO AND r.IDZONA = ad.IDZONA AND r.USUARIOCREACION = ad.USUARIOCREACION) 
inner join  CLIENTE c on r.IDRECEPTORRECIBO=c.IDCLIENTE
WHERE 
    (a.IDANEXO,a.IDZONA, a.USUARIOCREACION) IN (
(60346,70,'v0172'))
  GROUP BY a.IDANEXO, a.IDZONA,a.USUARIOCREACION
   ;


select *
from dbafv.anexodetalle ad INNER join anexo  a 
	ON (a.IDANEXO = ad.IDANEXO AND a.IDZONA = ad.IDZONA AND a.USUARIOCREACION = ad.USUARIOCREACION) 
where  substring(a.NUMEROPLANILLA, -8) ='79900091'

select *
from dbafv.anexodetalle ad INNER join anexo  a 
	ON (a.IDANEXO = ad.IDANEXO AND a.IDZONA = ad.IDZONA AND a.USUARIOCREACION = ad.USUARIOCREACION) 
where  substring(a.NUMEROPLANILLA, -8) ='25820399'


select *
from dbafv.anexodetalle ad INNER join anexo  a 
	ON (a.IDANEXO = ad.IDANEXO AND a.IDZONA = ad.IDZONA AND a.USUARIOCREACION = ad.USUARIOCREACION) 
where  ad.IDCLIENTE =15138;


select *
from dbafv.anexodetalle ad INNER join anexo  a 
	ON (a.IDANEXO = ad.IDANEXO AND a.IDZONA = ad.IDZONA AND a.USUARIOCREACION = ad.USUARIOCREACION) 
where  a.IDANEXO = '60346' and a.IDZONA =70 and a.USUARIOCREACION ='v0172';


select * from cliente c where c.IDCLIENTE=28404;


select * from movcomercial where nromovfiscal  = '02266227';
select * from transacciones where numerofiscal = '02266227';
select * from movcomercialimpuesto where idmovcomercial ='403866';
select * from movcomercialarticulo where idmovcomercial ='403866';

select * from movcomercial where nromovfiscal  = '02266181';
select * from transacciones where numerofiscal = '02266181';
select * from movcomercialimpuesto where idmovcomercial ='403771';
select * from movcomercialarticulo where idmovcomercial ='403771';


select * from cliente c where c.CODNEMONICO ='2937021';
select * from ext_freightrule ef; 
where ef.id

select * from recibo r where r.IDRECIBO ='60902' and r.IDRECEPTORRECIBO =23831;

(60902,216,'v0045')




--- -PARA REVISAR FLETE EN AFV 


select * from DBAFV.paramapp ;


select * from dbafv.cliente where cliente.CODNEMONICO = '6521521';

select * from dbafv.regla_descuento rd where RD.ID_REGLADESCUENTO = 14;

select * from dbafv.ext_freightrule where ext_freightrule.EXT_FREIGHTRULE_ID = 17846;


select * from dbafv.ext_freightrule where ext_freightrule.EXT_FREIGHTRULE_ID = 17002    ;


select * from dbafv.clientedireccion where clientedireccion.IDCLIENTE = 17002  ;


select * from dbafv.cliente c where c.CODNEMONICO ='2550078';

select * from dbafv.cyc_clienterepresentante cc where cc.IDCLIENTE =17846;


SELECT r.IDRECIBO, r.IDZONA , r.USUARIOCREACION 
FROM RECIBO r 
WHERE 
	r.IDRECIBO in ('61366') 
	and r.IDRECEPTORRECIBO =25004;

SELECT *
FROM RECIBO r 
WHERE 
	r.IDRECIBO in ('60704') 
	and r.IDZONA =188 and r.USUARIOCREACION ='v0030';


	and r.IDRECEPTORRECIBO =25004;

	61366,262,'v0030';


select * from dbafv.movcomercialarticulo m;



